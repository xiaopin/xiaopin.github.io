<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <link rel="dns-prefetch" href="http://www.0daybug.com">
  <title>å´å“è¯šçš„æŠ€æœ¯åšå®¢</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="å¸Œæœ›é€šè¿‡è¿™ä¸ªåšå®¢ï¼Œèƒ½å¤Ÿå°†è‡ªå·±çš„å­¦ä¹ æˆæœæ€»ç»“å‡ºæ¥ï¼Œä¸å¤§å®¶åˆ†äº«äº¤æµã€‚">
<meta property="og:type" content="website">
<meta property="og:title" content="å´å“è¯šçš„æŠ€æœ¯åšå®¢">
<meta property="og:url" content="http://www.0daybug.com/index.html">
<meta property="og:site_name" content="å´å“è¯šçš„æŠ€æœ¯åšå®¢">
<meta property="og:description" content="å¸Œæœ›é€šè¿‡è¿™ä¸ªåšå®¢ï¼Œèƒ½å¤Ÿå°†è‡ªå·±çš„å­¦ä¹ æˆæœæ€»ç»“å‡ºæ¥ï¼Œä¸å¤§å®¶åˆ†äº«äº¤æµã€‚">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="å´å“è¯šçš„æŠ€æœ¯åšå®¢">
<meta name="twitter:description" content="å¸Œæœ›é€šè¿‡è¿™ä¸ªåšå®¢ï¼Œèƒ½å¤Ÿå°†è‡ªå·±çš„å­¦ä¹ æˆæœæ€»ç»“å‡ºæ¥ï¼Œä¸å¤§å®¶åˆ†äº«äº¤æµã€‚">
  
    <link rel="alternative" href="/atom.xml" title="å´å“è¯šçš„æŠ€æœ¯åšå®¢" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/main.css">
  

</head>

<body>
  <div id="container">
    <div class="left-col">
      <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img src="/images/avatar.jpg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">å´å“è¯š</a></h1>
		</hgroup>

		
		<p class="header-subtitle">è®°å½•ç‚¹æ»´ç å†œç”Ÿæ´»</p>
		

		<nav class="header-menu">
			<ul>
			
				<li><a href="/">ä¸»é¡µ</a></li>
	        
				<li><a href="/tags/éšç¬”">éšç¬”</a></li>
	        
			</ul>
		</nav>
		<nav class="header-smart-menu">
	        
    		
    			
    			<a class="js-smart-menu" data-idx="0" href="javascript:void(0)">æ‰€æœ‰æ–‡ç« </a>
    			
    			
            
    			
    			<a class="js-smart-menu" data-idx="1" href="javascript:void(0)">æ ‡ç­¾</a>
    			
    			
            
    			
    			<a class="js-smart-menu" data-idx="2" href="javascript:void(0)">å‹é“¾</a>
    			
    			
            
    			
    			<a class="js-smart-menu" data-idx="3" href="javascript:void(0)">å…³äºæˆ‘</a>
    			
    			
            
		</nav>
		<nav class="header-nav">
			<div class="social">
				
					<a class="github" target="_blank" href="https://github.com/xiaopin" title="github">github</a>
		        
					<a class="weibo" target="_blank" href="http://weibo.com/u/2637356434" title="weibo">weibo</a>
		        
			</div>
		</nav>
	</header>		
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"><i class="icon-list"></i></div>
  		<h1 class="header-author js-mobile-header hide">å´å“è¯š</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				
					<img src="/images/avatar.jpg" class="js-avatar">
				
			</div>
			<hgroup>
			  <h1 class="header-author">å´å“è¯š</h1>
			</hgroup>
			
			<p class="header-subtitle">è®°å½•ç‚¹æ»´ç å†œç”Ÿæ´»</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">ä¸»é¡µ</a></li>
		        
					<li><a href="/tags/éšç¬”">éšç¬”</a></li>
		        
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/xiaopin" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="http://weibo.com/u/2637356434" title="weibo">weibo</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <div class="body-wrap">
        
  
    <article id="post-swift-OptionSet" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/04/13/swift-OptionSet/">Swifté€‰é¡¹é›†åˆ(OptionSet)</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="Objective-Cä¸­çš„NS-OPTIONå®"><a href="#Objective-Cä¸­çš„NS-OPTIONå®" class="headerlink" title="Objective-Cä¸­çš„NS_OPTIONå®"></a>Objective-Cä¸­çš„NS_OPTIONå®</h3><p>å¯¹äºiOSå¼€å‘è€…æ¥è¯´ï¼Œ<code>NS_OPTION</code>è¿™ä¸ªå®åº”è¯¥éƒ½ä¸ä¼šé™Œç”Ÿå§ï¼Œè¿™ä¸ªå®ç»™æˆ‘ä»¬çš„å¼€å‘å¸¦æ¥äº†æå¤§çš„ä¾¿åˆ©ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typedef</span> <span class="built_in">NS_OPTIONS</span>(<span class="built_in">NSUInteger</span>, <span class="built_in">UIViewAutoresizing</span>) &#123;</div><div class="line">    <span class="built_in">UIViewAutoresizingNone</span>                 = <span class="number">0</span>,</div><div class="line">    <span class="built_in">UIViewAutoresizingFlexibleLeftMargin</span>   = <span class="number">1</span> &lt;&lt; <span class="number">0</span>,</div><div class="line">    <span class="built_in">UIViewAutoresizingFlexibleWidth</span>        = <span class="number">1</span> &lt;&lt; <span class="number">1</span>,</div><div class="line">    <span class="built_in">UIViewAutoresizingFlexibleRightMargin</span>  = <span class="number">1</span> &lt;&lt; <span class="number">2</span>,</div><div class="line">    <span class="built_in">UIViewAutoresizingFlexibleTopMargin</span>    = <span class="number">1</span> &lt;&lt; <span class="number">3</span>,</div><div class="line">    <span class="built_in">UIViewAutoresizingFlexibleHeight</span>       = <span class="number">1</span> &lt;&lt; <span class="number">4</span>,</div><div class="line">    <span class="built_in">UIViewAutoresizingFlexibleBottomMargin</span> = <span class="number">1</span> &lt;&lt; <span class="number">5</span></div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>Objective-Cä¸­å¯ä»¥é€šè¿‡<code>|</code>æ¥ç»„åˆé€‰é¡¹ï¼Œé€šè¿‡<code>&amp;</code>æ¥åˆ¤æ–­ç»™å®šçš„é€‰é¡¹ä¸­æ˜¯å¦åŒ…å«æŸä¸ªæˆå‘˜ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">UIViewAutoresizing</span> autoresizing = <span class="built_in">UIViewAutoresizingFlexibleWidth</span> | <span class="built_in">UIViewAutoresizingFlexibleHeight</span>;</div><div class="line"><span class="keyword">if</span> (autoresizing &amp; <span class="built_in">UIViewAutoresizingFlexibleWidth</span>) &#123;</div><div class="line">    ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>é€šè¿‡<code>|=</code>æ¥è¿½åŠ é€‰é¡¹ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">autoresizing |= <span class="built_in">UIViewAutoresizingFlexibleLeftMargin</span>;</div></pre></td></tr></table></figure>
<h3 id="OptionSetåè®®"><a href="#OptionSetåè®®" class="headerlink" title="OptionSetåè®®"></a>OptionSetåè®®</h3><p>Swiftä½¿ç”¨structæ¥éµä»<code>OptionSet</code>åè®®ï¼Œä»¥å¼•å…¥é€‰é¡¹é›†åˆï¼Œè€Œéenumã€‚ä¸ºä»€ä¹ˆè¿™æ ·å¤„ç†å‘¢ï¼Ÿå½“æšä¸¾æˆå‘˜äº’æ–¥çš„æ—¶å€™ï¼Œæ¯”å¦‚è¯´ï¼Œä¸€æ¬¡åªæœ‰ä¸€ä¸ªé€‰é¡¹å¯ä»¥è¢«é€‰æ‹©çš„æƒ…å†µä¸‹ï¼Œæšä¸¾æ˜¯éå¸¸å¥½çš„ã€‚ä½†æ˜¯å’Œ C ä¸åŒï¼Œåœ¨ Swift ä¸­ï¼Œä½ æ— æ³•æŠŠå¤šä¸ªæšä¸¾æˆå‘˜ç»„åˆæˆä¸€ä¸ªå€¼ï¼Œè€Œ C ä¸­çš„æšä¸¾å¯¹ç¼–è¯‘å™¨æ¥è¯´å°±æ˜¯æ•´å‹ï¼Œå¯ä»¥æ¥å—ä»»æ„æ•´æ•°å€¼ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Hobbies</span>: <span class="title">OptionSet</span> </span>&#123;</div><div class="line">    <span class="keyword">var</span> rawValue: <span class="type">UInt</span></div><div class="line">    </div><div class="line">    <span class="keyword">static</span> <span class="keyword">let</span> <span class="keyword">none</span>         = <span class="type">Hobbies</span>(rawValue: <span class="number">0</span>) <span class="comment">// è¿™äººå¾ˆæ‡’,å±…ç„¶æ²¡ä»»ä½•çˆ±å¥½ğŸ˜‚</span></div><div class="line">    <span class="keyword">static</span> <span class="keyword">let</span> basketball   = <span class="type">Hobbies</span>(rawValue: <span class="number">1</span> &lt;&lt; <span class="number">0</span>)</div><div class="line">    <span class="keyword">static</span> <span class="keyword">let</span> football     = <span class="type">Hobbies</span>(rawValue: <span class="number">1</span> &lt;&lt; <span class="number">1</span>)</div><div class="line">    <span class="keyword">static</span> <span class="keyword">let</span> baseball     = <span class="type">Hobbies</span>(rawValue: <span class="number">1</span> &lt;&lt; <span class="number">2</span>)</div><div class="line">    <span class="keyword">static</span> <span class="keyword">let</span> swim         = <span class="type">Hobbies</span>(rawValue: <span class="number">1</span> &lt;&lt; <span class="number">3</span>)</div><div class="line">    <span class="keyword">static</span> <span class="keyword">let</span> badminton    = <span class="type">Hobbies</span>(rawValue: <span class="number">1</span> &lt;&lt; <span class="number">4</span>)</div><div class="line">    <span class="keyword">static</span> <span class="keyword">let</span> all: <span class="type">Hobbies</span> = [.basketball, .football, .baseball, .swim, .badminton]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å’ŒCä¸€æ ·ï¼ŒSwiftä¸­çš„é€‰é¡¹é›†åˆç»“æ„ä½“ä½¿ç”¨äº†é«˜æ•ˆçš„ä½åŸŸæ¥è¡¨ç¤ºï¼Œä½†æ˜¯è¿™ä¸ªç»“æ„ä½“æœ¬èº«è¡¨ç°ä¸ºä¸€ä¸ªé›†åˆï¼Œå®ƒçš„æˆå‘˜åˆ™ä¸ºè¢«é€‰æ‹©çš„é€‰é¡¹ã€‚è¿™å…è®¸ä½ ä½¿ç”¨æ ‡å‡†çš„é›†åˆè¿ç®—æ¥ç»´æŠ¤ä½åŸŸï¼Œæ¯”å¦‚ä½¿ç”¨<code>contains(_:)</code>æ¥æ£€éªŒé›†åˆä¸­æ˜¯å¦æœ‰æŸä¸ªæˆå‘˜ï¼Œæˆ–è€…æ˜¯ç”¨<code>union(_:)</code>æ¥ç»„åˆä¸¤ä¸ªä½åŸŸï¼Œé€šè¿‡<code>remove(_:)</code>æ¥ç§»é™¤æŸä¸ªæˆå‘˜ã€‚å¦å¤–ï¼Œç”±äºOptionSetç»§æ‰¿äºExpressibleByArrayLiteralï¼Œä½ å¯ä»¥ä½¿ç”¨æ•°ç»„å­—é¢é‡æ¥ç”Ÿæˆä¸€ä¸ªé€‰é¡¹é›†åˆã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> hobbies: <span class="type">Hobbies</span> = [.football, .swim]</div><div class="line"><span class="number">_</span> = hobbies.<span class="built_in">contains</span>(.football) <span class="comment">// true</span></div><div class="line"><span class="number">_</span> = hobbies.<span class="built_in">contains</span>(.baseball) <span class="comment">// false</span></div><div class="line"><span class="comment">// å¢åŠ `.badminton`é€‰é¡¹</span></div><div class="line">hobbies = hobbies.union(.badminton)</div><div class="line"><span class="comment">// ç§»é™¤`.football`é€‰é¡¹</span></div><div class="line">hobbies.remove(.football)</div></pre></td></tr></table></figure>
<h3 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h3><p>ä½ å¯ä»¥åœ¨GitHubä¸ŠæŸ¥çœ‹åˆ°OptionSetçš„æºç <a href="https://github.com/apple/swift/blob/master/stdlib/public/core/OptionSet.swift" target="_blank" rel="external"><code>swift/stdlib/public/core/OptionSet.swift</code></a>ï¼Œå¦‚æœä½ æœ‰å…´è¶£ã€‚</p>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2018/04/13/swift-OptionSet/" class="archive-article-date">
  	<time datetime="2018-04-13T00:46:38.000Z" itemprop="datePublished"><i class="icon-clock"></i>2018-04-13</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Swift/">Swift</a></li></ul>
	</div>

      

      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-iOS-waterfall-layout" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/04/10/iOS-waterfall-layout/">UICollectionViewç€‘å¸ƒæµå¸ƒå±€</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>ä»…ä½œä¸ºå­¦ä¹ äº¤æµä¹‹ç”¨</p>
</blockquote>
<h3 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h3><ul>
<li>Xcode9.0+</li>
<li>Swift4.0+</li>
</ul>
<h3 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h3><ul>
<li>åºŸå¼ƒ<code>CollectionViewWaterfallLayout</code>çš„<code>contentInset</code>å±æ€§ï¼Œæ”¹ç”¨UICollectionViewçš„<code>contentInset</code>å±æ€§ã€‚</li>
</ul>
<p>ä¸€å¼€å§‹æ˜¯é‡‡ç”¨<code>UICollectionView.contentInset</code>æ¥åšå››å‘¨ç•™ç™½çš„ï¼Œä½†æ˜¯åæ¥å‘ç°ä¸€æ—¦è®¾ç½®äº†<code>UICollectionView.contentInset.left</code>çš„å€¼ä¸”<code>&gt;0</code>çš„æ—¶å€™ï¼Œæ•´ä¸ªUICollectionViewå°±ä¼šä¸€ç‰‡ç©ºç™½ï¼Œä½†æ˜¯topã€bottomã€rightå±æ€§å‡ä¸å—æ­¤å½±å“ã€‚æµ‹è¯•äº†ç½‘ä¸Šçš„ä¸€äº›Demoä¹Ÿå‘ç°å­˜åœ¨æ­¤é—®é¢˜ï¼Œå…·ä½“åŸå› ä¸è¯¦ï¼Œå¦‚æœ‰çŸ¥é“çš„è¿˜æœ›èµæ•™ã€‚</p>
<p>é‰´äºæ­¤ï¼Œæš‚æ—¶ç»™CollectionViewWaterfallLayoutå¢åŠ äº†ä¸€ä¸ªcontentInsetå±æ€§ã€‚</p>
<h3 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">CollectionViewDelegateWaterfallLayout</span> </span>&#123;</div><div class="line">    </div><div class="line">    <span class="comment">/// è¿”å›æ¯ä¸ªcellçš„é«˜åº¦</span></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">collectionView</span><span class="params">(<span class="number">_</span> collectionView: UICollectionView, layout collectionViewLayout: UICollectionViewLayout, heightForItemAt indexPath: IndexPath, itemWidth width: CGFloat)</span></span> -&gt; <span class="type">CGFloat</span></div><div class="line">    </div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CollectionViewWaterfallLayout</span>: <span class="title">UICollectionViewLayout</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="comment">/// çºµåˆ—æ•°é‡</span></div><div class="line">    <span class="keyword">var</span> column: <span class="type">Int</span> = <span class="number">2</span></div><div class="line">    <span class="comment">/// æ¯ä¸€è¡Œcellä¹‹é—´çš„é—´è·</span></div><div class="line">    <span class="keyword">var</span> minimumLineSpacing: <span class="type">CGFloat</span> = <span class="number">5.0</span></div><div class="line">    <span class="comment">/// æ¯ä¸€çºµåˆ—cellä¹‹é—´çš„é—´è·</span></div><div class="line">    <span class="keyword">var</span> minimumInteritemSpacing: <span class="type">CGFloat</span> = <span class="number">5.0</span></div><div class="line">    <span class="comment">///</span></div><div class="line">    <span class="keyword">var</span> delegate: <span class="type">CollectionViewDelegateWaterfallLayout</span>?</div><div class="line">    <span class="comment">/// å†…å®¹åç§»</span></div><div class="line">    <span class="keyword">var</span> contentInset: <span class="type">UIEdgeInsets</span> = .zero</div><div class="line">    <span class="comment">/// æ¯ä¸ªçºµåˆ—çš„Yå€¼åç§»é‡</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">var</span> maxYForColumn = [<span class="type">CGFloat</span>]()</div><div class="line">    <span class="comment">/// å¸ƒå±€æ•°æ®</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">var</span> layoutAttributes = [<span class="type">UICollectionViewLayoutAttributes</span>]()</div><div class="line">    </div><div class="line">    <span class="keyword">override</span> <span class="keyword">var</span> collectionViewContentSize: <span class="type">CGSize</span> &#123;</div><div class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> <span class="built_in">max</span> = maxYForColumn.<span class="built_in">max</span>() <span class="keyword">else</span> &#123; <span class="keyword">return</span> .zero &#125;</div><div class="line">        <span class="keyword">return</span> <span class="type">CGSize</span>(width: <span class="number">0.0</span>, height: <span class="built_in">max</span> + contentInset.bottom)</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">prepare</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">super</span>.prepare()</div><div class="line">        maxYForColumn = <span class="type">Array</span>(repeating: contentInset.top, <span class="built_in">count</span>: column)</div><div class="line">        layoutAttributes.removeAll()</div><div class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> collectionView = collectionView <span class="keyword">else</span> &#123; <span class="keyword">return</span> &#125;</div><div class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> delegate = delegate <span class="keyword">else</span> &#123;</div><div class="line">            <span class="built_in">assertionFailure</span>(<span class="string">"delegate can'not be nil."</span>)</div><div class="line">            <span class="keyword">return</span></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">let</span> contentWidth = collectionView.bounds.width - contentInset.<span class="keyword">left</span> - contentInset.<span class="keyword">right</span></div><div class="line">        <span class="keyword">let</span> width = (contentWidth - <span class="type">CGFloat</span>(column - <span class="number">1</span>) * minimumInteritemSpacing) / <span class="type">CGFloat</span>(column)</div><div class="line">        <span class="keyword">let</span> itemCount = collectionView.numberOfItems(inSection: <span class="number">0</span>)</div><div class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> <span class="number">0</span>..&lt;itemCount &#123;</div><div class="line">            <span class="keyword">let</span> indexPath = <span class="type">IndexPath</span>(item: item, section: <span class="number">0</span>)</div><div class="line">            <span class="keyword">let</span> height = delegate.collectionView(collectionView, layout: <span class="keyword">self</span>, heightForItemAt: indexPath, itemWidth: width)</div><div class="line">            <span class="comment">// è®¡ç®—å½“å‰cellåº”è¯¥å±•ç¤ºåœ¨å“ªä¸€åˆ—ä¸Š</span></div><div class="line">            <span class="keyword">var</span> targetColumn: <span class="type">Int</span></div><div class="line">            <span class="keyword">if</span> item &lt; column &#123;</div><div class="line">                targetColumn = item</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">let</span> <span class="built_in">min</span> = maxYForColumn.<span class="built_in">min</span>()!</div><div class="line">                targetColumn = maxYForColumn.index(of: <span class="built_in">min</span>)!</div><div class="line">            &#125;</div><div class="line">            <span class="comment">// è®¡ç®—frame</span></div><div class="line">            <span class="keyword">let</span> x = contentInset.<span class="keyword">left</span> + width * <span class="type">CGFloat</span>(targetColumn) + <span class="type">CGFloat</span>(targetColumn) * minimumInteritemSpacing</div><div class="line">            <span class="keyword">let</span> y = minimumLineSpacing + maxYForColumn[targetColumn]</div><div class="line">            <span class="keyword">let</span> attribute = <span class="type">UICollectionViewLayoutAttributes</span>(forCellWith: indexPath)</div><div class="line">            attribute.frame = <span class="type">CGRect</span>(x: x, y: y, width: width, height: height)</div><div class="line">            layoutAttributes.append(attribute)</div><div class="line">            <span class="comment">// æ›´æ–°å½“å‰åˆ—çš„Yå€¼åç§»é‡</span></div><div class="line">            maxYForColumn[targetColumn] = y + height</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">layoutAttributesForItem</span><span class="params">(at indexPath: IndexPath)</span></span> -&gt; <span class="type">UICollectionViewLayoutAttributes</span>? &#123;</div><div class="line">        <span class="keyword">return</span> layoutAttributes[indexPath.item]</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">layoutAttributesForElements</span><span class="params">(<span class="keyword">in</span> rect: CGRect)</span></span> -&gt; [<span class="type">UICollectionViewLayoutAttributes</span>]? &#123;</div><div class="line">        <span class="keyword">return</span> layoutAttributes</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">shouldInvalidateLayout</span><span class="params">(forBoundsChange newBounds: CGRect)</span></span> -&gt; <span class="type">Bool</span> &#123;</div><div class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> collectionView = collectionView <span class="keyword">else</span> &#123; <span class="keyword">return</span> <span class="literal">false</span> &#125;</div><div class="line">        <span class="keyword">return</span> !collectionView.bounds.size.equalTo(newBounds.size)</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2018/04/10/iOS-waterfall-layout/" class="archive-article-date">
  	<time datetime="2018-04-10T08:28:58.000Z" itemprop="datePublished"><i class="icon-clock"></i>2018-04-10</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Swift/">Swift</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li></ul>
	</div>

      

      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-iOS-copy-paste-phone-from-contacts" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/03/30/iOS-copy-paste-phone-from-contacts/">iOSä»é€šè®¯å½•ä¸­å¤åˆ¶ç²˜è´´ç”µè¯å·ç æºå¸¦ç‰¹æ®Šå­—ç¬¦</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>åœ¨åšæ”¶è´§åœ°å€çš„åŠŸèƒ½ï¼Œå…¶ä¸­æœ‰ä¸ªåœºæ™¯å°±æ˜¯ç”¨æˆ·å…ˆä»æ‰‹æœº<code>é€šè®¯å½•</code>ä¸­æ‹·è´äº†æŸä¸ªç”µè¯å·ç ï¼Œç„¶åå°†å…¶ç²˜è´´åˆ°è¾“å…¥æ¡†ä¸­ã€‚ä¸€åˆ‡çœ‹ä¼¼æ­£å¸¸ï¼Œä½†æ˜¯è¿™é‡Œæœ‰ä¸ªé—®é¢˜ï¼Œä»é€šè®¯å½•ä¸­æ‹·è´çš„ç”µè¯å·ç ï¼Œè‡ªå¸¦äº†ç‰¹æ®Šçš„ä¸å¯è§unicodeå­—ç¬¦ï¼Œå¦‚æœä½ ä¸æ‰“æ–­ç‚¹æŸ¥çœ‹å˜é‡å€¼ï¼Œå‹æ ¹ä¸ä¼šçœ‹åˆ°è¿™äº›ç‰¹æ®Šå­—ç¬¦ã€‚</p>
<h4 id="ç‰¹æ®Šå­—ç¬¦"><a href="#ç‰¹æ®Šå­—ç¬¦" class="headerlink" title="ç‰¹æ®Šå­—ç¬¦"></a>ç‰¹æ®Šå­—ç¬¦</h4><p>è¿™äº›ç‰¹æ®Šå­—ç¬¦åœ¨OCå’ŒSwiftä¸­æœ‰ä¸åŒçš„è¡¨ç°å½¢å¼:</p>
<p>Objective-C:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">phone	__NSCFString *	@&quot;\U0000202d(888) 555-5512\U0000202c&quot;	0x000060000065b7b0</div></pre></td></tr></table></figure></p>
<p>Swift:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">phone	String	&quot;\u&#123;e2&#125;(888) 555-5512\u&#123;e2&#125;&quot;</div></pre></td></tr></table></figure></p>
<h4 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h4><p>Swift:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">removeSpecialCharactersForPhoneNumber</span><span class="params">(<span class="number">_</span> phone: String)</span></span> -&gt; <span class="type">String</span> &#123;</div><div class="line">    <span class="keyword">var</span> result = phone</div><div class="line">    [<span class="string">"+86"</span>,<span class="string">"+"</span>,<span class="string">"-"</span>,<span class="string">"("</span>,<span class="string">")"</span>,<span class="string">" "</span>].forEach &#123;</div><div class="line">        result = result.replacingOccurrences(of: $<span class="number">0</span>, with: <span class="string">""</span>)</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// è¿‡æ»¤`é€šè®¯å½•`æ‹·è´çš„ç‰¹æ®Šå­—ç¬¦</span></div><div class="line">    result = result.replacingOccurrences(of: <span class="string">"\\p&#123;Cf&#125;"</span>, with: <span class="string">""</span>, options: .regularExpression)</div><div class="line">    <span class="keyword">return</span> result</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Objective-C</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[phone stringByReplacingOccurrencesOfString:<span class="string">@"\\p&#123;Cf&#125;"</span> withString:<span class="string">@""</span> options:<span class="built_in">NSRegularExpressionSearch</span> range:<span class="built_in">NSMakeRange</span>(<span class="number">0</span>, phone.length)]</div></pre></td></tr></table></figure>
<p>å‚è€ƒ: <a href="https://stackoverflow.com/questions/47623828/ios-copy-paste-phone-from-contacts-to-uitextfield-adds-strange-unicode-character" target="_blank" rel="external">https://stackoverflow.com/questions/47623828/ios-copy-paste-phone-from-contacts-to-uitextfield-adds-strange-unicode-character</a></p>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2018/03/30/iOS-copy-paste-phone-from-contacts/" class="archive-article-date">
  	<time datetime="2018-03-30T09:16:51.000Z" itemprop="datePublished"><i class="icon-clock"></i>2018-03-30</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li></ul>
	</div>

      

      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-swift-substr" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/03/29/swift-substr/">Swiftæˆªå–å­å­—ç¬¦ä¸²</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>åœ¨Swiftä¸­æˆªå–å­ä¸²ï¼Œä¸€ç›´æ˜¯ä¸ªå¤´ç–¼çš„é—®é¢˜ï¼Œæ¯•ç«Ÿç‰µæ¶‰åˆ°<code>String.Index</code>è¿™ä¸ªé¬¼ä¸œè¥¿ï¼Œè€Œä¸”APIè¿˜ä¸å¥½ç”¨ã€‚ç°åœ¨è¿<code>substring(to:)</code>ã€<code>substring(from:)</code>ã€<code>substring(width:)</code>è¿™å‡ ä¸ªæ–¹æ³•ä¹Ÿè¢«åºŸå¼ƒäº†ã€‚</p>
<h3 id="One-sided-Slicing"><a href="#One-sided-Slicing" class="headerlink" title="One-sided Slicing"></a><strong><em>One-sided Slicing</em></strong></h3><p>å¥½åœ¨Swift4ä¹‹åï¼Œè‹¹æœä¸ºStringå¢åŠ äº†ä¸€ä¸ªè¯­æ³•ç³–<code>...</code>ï¼Œå¯ä»¥å¯¹å­—ç¬¦ä¸²è¿›è¡Œå•ä¾§è¾¹ç•Œå–å­ä¸²ã€‚æ³¨æ„è¿”å›çš„ç±»å‹æ˜¯<code>Substring</code>è€Œä¸æ˜¯<code>String</code>ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">String</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="comment">/// æˆªå–å­å­—ç¬¦ä¸²</span></div><div class="line">    <span class="comment">///</span></div><div class="line">    <span class="comment">/// - Parameters:</span></div><div class="line">    <span class="comment">///   - start: è¦æŠ½å–çš„å­ä¸²çš„èµ·å§‹ä¸‹æ ‡ã€‚å¦‚æœæ˜¯è´Ÿæ•°ï¼Œé‚£ä¹ˆè¯¥å‚æ•°å£°æ˜ä»å­—ç¬¦ä¸²çš„å°¾éƒ¨å¼€å§‹ç®—èµ·çš„ä½ç½®ã€‚</span></div><div class="line">    <span class="comment">///            ä¹Ÿå°±æ˜¯è¯´ï¼Œ-1 æŒ‡å­—ç¬¦ä¸²ä¸­æœ€åä¸€ä¸ªå­—ç¬¦ï¼Œ-2 æŒ‡å€’æ•°ç¬¬äºŒä¸ªå­—ç¬¦ï¼Œä»¥æ­¤ç±»æ¨ã€‚</span></div><div class="line">    <span class="comment">///   - length: æˆªå–é•¿åº¦ã€‚å¦‚æœçœç•¥äº†è¯¥å‚æ•°ï¼Œé‚£ä¹ˆè¿”å›ä»`start`å¼€å§‹åˆ°ç»“å°¾çš„å­ä¸²ã€‚</span></div><div class="line">    <span class="comment">/// - Returns: å­å­—ç¬¦ä¸²</span></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">substr</span><span class="params">(<span class="number">_</span> start: Int, length: UInt? = <span class="literal">nil</span>)</span></span> -&gt; <span class="type">String</span>? &#123;</div><div class="line">        <span class="keyword">if</span> <span class="built_in">abs</span>(start) &gt;= <span class="built_in">count</span> &#123; <span class="keyword">return</span> <span class="literal">nil</span> &#125;</div><div class="line">        <span class="keyword">let</span> offset = (start &gt;= <span class="number">0</span>) ? start : <span class="built_in">count</span>+start</div><div class="line">        <span class="keyword">let</span> s = <span class="keyword">self</span>.index(startIndex, offsetBy: offset)</div><div class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> length = length <span class="keyword">else</span> &#123;</div><div class="line">            <span class="comment">// length==nil,ç›´æ¥æˆªå–åˆ°å­—ç¬¦ä¸²ç»“å°¾</span></div><div class="line">            <span class="keyword">return</span> <span class="type">String</span>(<span class="keyword">self</span>[s...])</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">let</span> e = <span class="keyword">self</span>.index(startIndex, offsetBy: <span class="built_in">min</span>(offset+<span class="type">Int</span>(length), <span class="built_in">count</span>))</div><div class="line">        <span class="keyword">return</span> <span class="type">String</span>(<span class="keyword">self</span>[s..&lt;e])</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¦‚æœæ‡‚JavaScriptçš„è¯ï¼Œä¸€çœ‹å°±æ‡‚ï¼Œè¿™å‡½æ•°å’ŒJSçš„substræ˜¯ä¸€æ ·çš„ç”¨æ³•ã€‚</p>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2018/03/29/swift-substr/" class="archive-article-date">
  	<time datetime="2018-03-29T06:57:02.000Z" itemprop="datePublished"><i class="icon-clock"></i>2018-03-29</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Swift/">Swift</a></li></ul>
	</div>

      

      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-swift4-Codable" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/03/26/swift4-Codable/">Swift4ä¹‹Codableåè®®</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>æœ€è¿‘å…¬å¸æ–°é¡¹ç›®é‡‡ç”¨äº†Swiftå¼€å‘ï¼Œåœ¨å¤„ç†JSONæ•°æ®æ—¶ï¼Œä¸€å¼€å§‹æ˜¯å‡†å¤‡é‡‡ç”¨é˜¿é‡Œå¼€æºçš„<a href="https://github.com/alibaba/HandyJSON" target="_blank" rel="external">HandyJSON</a>ï¼Œåæ¥äº†è§£äº†ä¸‹ï¼Œéšç€Swift4çš„åˆ°æ¥ï¼Œè‹¹æœä¸ºæˆ‘ä»¬å¸¦æ¥äº†<a href="https://developer.apple.com/documentation/foundation/archives_and_serialization/encoding_and_decoding_custom_types" target="_blank" rel="external"><code>Codable</code></a>åè®®ï¼Œç”¨äºæ•°æ®çš„ç¼–è§£ç ï¼Œè™½ç„¶ç°åœ¨çš„Codableå¹¶ä¸å®Œå–„ï¼Œä½¿ç”¨ä¸Šä¹Ÿå¹¶æ²¡æœ‰é‚£ä¹ˆçš„å‹å¥½ï¼Œä½†æ˜¯æ¯•ç«Ÿæ˜¯å®˜æ–¹å‡ºå“ï¼ŒåæœŸè‚¯å®šä¼šè¶Šæ¥è¶Šå®Œå–„çš„ï¼Œæ‰€ä»¥å†³å®šé‡‡ç”¨Codableè€Œå¼ƒç”¨HandyJSONã€‚</p>
<h2 id="åŸºç¡€"><a href="#åŸºç¡€" class="headerlink" title="åŸºç¡€"></a>åŸºç¡€</h2><p>é¦–å…ˆï¼ŒCodableæ˜¯<code>Decodable</code>åè®®å’Œ<code>Encodable</code>åè®®çš„ç»„åˆç±»å‹ï¼Œå®ƒä»¬åˆ†åˆ«å®šä¹‰äº†<code>init(from decoder: Decoder) throws</code>å’Œ<code>func encode(to encoder: Encoder) throws</code>æ–¹æ³•ã€‚å¦‚æœæˆ‘ä»¬åªéœ€å•å‘è½¬æ¢ï¼Œé€‰æ‹©å…¶ä¸€å³å¯ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/// A type that can encode itself to an external representation.</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">protocol</span> <span class="title">Encodable</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="comment">/// Encodes this value into the given encoder.</span></div><div class="line">    <span class="comment">///</span></div><div class="line">    <span class="comment">/// If the value fails to encode anything, `encoder` will encode an empty</span></div><div class="line">    <span class="comment">/// keyed container in its place.</span></div><div class="line">    <span class="comment">///</span></div><div class="line">    <span class="comment">/// This function throws an error if any values are invalid for the given</span></div><div class="line">    <span class="comment">/// encoder's format.</span></div><div class="line">    <span class="comment">///</span></div><div class="line">    <span class="comment">/// - Parameter encoder: The encoder to write data to.</span></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">encode</span><span class="params">(to encoder: Encoder)</span></span> <span class="keyword">throws</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/// A type that can decode itself from an external representation.</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">protocol</span> <span class="title">Decodable</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="comment">/// Creates a new instance by decoding from the given decoder.</span></div><div class="line">    <span class="comment">///</span></div><div class="line">    <span class="comment">/// This initializer throws an error if reading from the decoder fails, or</span></div><div class="line">    <span class="comment">/// if the data read is corrupted or otherwise invalid.</span></div><div class="line">    <span class="comment">///</span></div><div class="line">    <span class="comment">/// - Parameter decoder: The decoder to read data from.</span></div><div class="line">    <span class="keyword">public</span> <span class="keyword">init</span>(from decoder: <span class="type">Decoder</span>) <span class="keyword">throws</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/// A type that can convert itself into and out of an external representation.</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">typealias</span> <span class="type">Codable</span> = <span class="type">Decodable</span> &amp; <span class="type">Encodable</span></div></pre></td></tr></table></figure>
<h2 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h2><p>å¯ä»¥åœ¨Swiftæºç ç›®å½•<a href="https://github.com/apple/swift/blob/master/stdlib/public/SDK/Foundation/JSONEncoder.swift" target="_blank" rel="external">/stdlib/public/SDK/Foundation/JSONEncoder.swift</a>çœ‹åˆ°è‹¹æœè¿™è¯¥åŠŸèƒ½çš„å®ç°ã€‚</p>
<h2 id="JSONè½¬Model"><a href="#JSONè½¬Model" class="headerlink" title="JSONè½¬Model"></a>JSONè½¬Model</h2><p>æœ€ç†æƒ³çš„æƒ…å†µä¸‹ï¼Œå½“ç„¶æ˜¯æœåŠ¡å™¨è¿”å›çš„JSONæ•°æ®ä¸­keyå’Œæˆ‘ä»¬Modelä¸­å®šä¹‰çš„keyä¿æŒä¸€è‡´ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦å°†Modelå£°æ˜ä¸ºéµå®ˆCodableåè®®å³å¯ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Person</span>: <span class="title">Codable</span> </span>&#123;</div><div class="line">    <span class="keyword">var</span> name: <span class="type">String</span></div><div class="line">    <span class="keyword">var</span> age: <span class="type">Int</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥å°±å¯ä»¥ç›´æ¥å¯¹JSONæ•°æ®è¿›è¡Œè§£ç æ“ä½œäº†:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> data = <span class="string">"&#123;\"name\":\"xiaopin\", \"age\": 18&#125;"</span>.data(using: .utf8)!</div><div class="line"><span class="keyword">let</span> model = <span class="keyword">try</span>? <span class="type">JSONDecoder</span>().decode(<span class="type">Person</span>.<span class="keyword">self</span>, from: data)</div></pre></td></tr></table></figure>
<p>çœ‹ï¼Œæ˜¯ä¸æ˜¯so easyï¼ä»£ç ç®€ç›´æ˜¯6åˆ°æ²¡æœ‹å‹å•Šã€‚</p>
<h2 id="è‡ªå®šä¹‰é”®å€¼"><a href="#è‡ªå®šä¹‰é”®å€¼" class="headerlink" title="è‡ªå®šä¹‰é”®å€¼"></a>è‡ªå®šä¹‰é”®å€¼</h2><ul>
<li>CodingKeyåè®®</li>
</ul>
<p>å½“ç„¶äº†ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹æˆ‘ä»¬éƒ½ä¼šé‡åˆ°æœåŠ¡å™¨è¿”å›çš„Keyä¸Modelå±æ€§åç§°ä¸ä¸€è‡´çš„æƒ…å†µï¼Œæ­¤æ—¶æˆ‘ä»¬å°±éœ€è¦è‡ªå·±å®šä¹‰æ˜ å°„å…³ç³»äº†ã€‚Codableä¹Ÿä¸ºæˆ‘ä»¬æä¾›äº†è§£å†³æ–¹æ¡ˆï¼Œæˆ‘ä»¬åªéœ€è¦å®šä¹‰ä¸€ä¸ªåç§°ä¸º<code>CodingKeys</code>çš„åµŒå¥—æšä¸¾ï¼Œå…³è”å€¼ç±»å‹ä¸ºStringï¼Œå¹¶éµå®ˆCodingKeyåè®®å³å¯ã€‚</p>
<p>å‡è®¾æˆ‘ä»¬éœ€è¦ç»™Personå¢åŠ ä¸€ä¸ªå­¦æ ¡ä¿¡æ¯ï¼ŒæœåŠ¡å™¨è¿”å›çš„Keyä¸º<code>school_name</code>ï¼Œè€Œæˆ‘ä»¬Modelä¸­åˆ™ä¸º<code>schoolName</code>ï¼Œæˆ‘ä»¬åªéœ€ç®€å•ä¿®æ”¹Personçš„å®šä¹‰å³å¯:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Person</span>: <span class="title">Codable</span> </span>&#123;</div><div class="line">    <span class="class"><span class="keyword">enum</span> <span class="title">CodingKeys</span>: <span class="title">String</span>, <span class="title">CodingKey</span> </span>&#123;</div><div class="line">        <span class="keyword">case</span> name, age</div><div class="line">        <span class="keyword">case</span> schoolName = <span class="string">"school_name"</span></div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">var</span> name: <span class="type">String</span></div><div class="line">    <span class="keyword">var</span> age: <span class="type">Int</span></div><div class="line">    <span class="keyword">var</span> schoolName: <span class="type">String</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>é€šè¿‡CodingKeysè¿™ä¸ªæšä¸¾ï¼Œæˆ‘ä»¬ä¾¿å¯è½»æ˜“å®ŒæˆJSON Keyå’ŒModelä¹‹é—´çš„æ˜ å°„å…³ç³»ã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œç¼–è¯‘å™¨ä¼šä¸ºæˆ‘ä»¬è‡ªåŠ¨ç”ŸæˆCodingKeysï¼Œå¹¶æä¾›<code>init(from decoder: Decoder) throws</code>å’Œ<code>func encode(to encoder: Encoder) throws</code>çš„é»˜è®¤å®ç°ã€‚</p>
<ul>
<li><code>keyDecodingStrategy</code>å±æ€§</li>
</ul>
<p>éšç€Swift4.1çš„æ›´æ–°ï¼ŒAppleç»™JSONDecoder/JSONEncoderæ‰©å±•äº†ä¸€ä¸ªkeyDecodingStrategyå±æ€§ï¼Œä¸ºæˆ‘ä»¬å¸¦æ¥æ›´åŠ æ–¹ä¾¿çš„è‡ªå®šä¹‰é”®å€¼æ˜ å°„åŠŸèƒ½ã€‚</p>
<p>keyDecodingStrategyæ˜¯ä¸€ä¸ªæšä¸¾å€¼ï¼Œæœ‰ä¸ªcaseæ˜¯<code>convertFromSnakeCase</code>ï¼Œå¯ä»¥åœ¨å¯¹è±¡/ç»“æ„ä½“çš„<code>Camel Case</code>æ ¼å¼çš„å±æ€§åå’ŒJSONçš„<code>Snake Case</code>æ ¼å¼çš„keyä¹‹é—´è½¬æ¢ï¼ˆå³åœ¨Decoderæ—¶ä¼šè‡ªåŠ¨å°†JSONä¸­çš„school_nameæ˜ å°„æˆPersonä¸­çš„schoolNameï¼‰ï¼Œè¿™ä¸ªæ˜¯æ ¸å¿ƒåŠŸèƒ½å†…ç½®çš„ï¼Œå°±ä¸éœ€è¦æˆ‘ä»¬é¢å¤–å†™ä»£ç å¤„ç†äº†ã€‚ä¸Šé¢åŠ ä¸Šçš„æšä¸¾CodingKeysä¹Ÿå¯ä»¥å»æ‰äº†ï¼Œåªéœ€è¦åœ¨JSONDecoderè¿™ä¸ªå®ä¾‹è®¾ç½®è¿™ä¸ªå±æ€§å°±è¡Œã€‚<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> decoder = <span class="type">JSONDecoder</span>()</div><div class="line">decoder.keyDecodingStrategy = .convertFromSnakeCase</div></pre></td></tr></table></figure></p>
<h2 id="æšä¸¾"><a href="#æšä¸¾" class="headerlink" title="æšä¸¾"></a>æšä¸¾</h2><p>Codableæä¾›å¯¹æšä¸¾çš„æ”¯æŒï¼Œåªéœ€å®šä¹‰å¥½æšä¸¾çš„å…³è”å€¼ç±»å‹ï¼Œå¹¶éµå®ˆCodableåè®®å³å¯ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬ç»™Personå¢åŠ ä¸€ä¸ªæ€§åˆ«å±æ€§:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Person</span>: <span class="title">Codable</span> </span>&#123;</div><div class="line">    <span class="class"><span class="keyword">enum</span> <span class="title">CodingKeys</span>: <span class="title">String</span>, <span class="title">CodingKey</span> </span>&#123;</div><div class="line">        <span class="keyword">case</span> name, age, gender</div><div class="line">        <span class="keyword">case</span> schoolName = <span class="string">"school_name"</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="class"><span class="keyword">enum</span> <span class="title">Gender</span>: <span class="title">String</span>, <span class="title">Codable</span> </span>&#123;</div><div class="line">        <span class="keyword">case</span> male, female</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">var</span> name: <span class="type">String</span></div><div class="line">    <span class="keyword">var</span> age: <span class="type">Int</span></div><div class="line">    <span class="keyword">var</span> gender: <span class="type">Gender</span></div><div class="line">    <span class="keyword">var</span> schoolName: <span class="type">String</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åªéœ€ç®€å•ä¿®æ”¹ï¼ŒCodableå°±ä¼šè‡ªåŠ¨ä¸ºæˆ‘ä»¬å°†JSONä¸­çš„genderå­—ç¬¦ä¸²è½¬æ¢ä¸ºå¯¹åº”çš„Genderæšä¸¾å€¼ã€‚</p>
<h2 id="æ—¥æœŸå¤„ç†"><a href="#æ—¥æœŸå¤„ç†" class="headerlink" title="æ—¥æœŸå¤„ç†"></a>æ—¥æœŸå¤„ç†</h2><blockquote>
<p>å®‰åˆ©ä¸€ä¸ªç½‘ç«™<a href="http://www.nsdateformatter.com" target="_blank" rel="external">www.nsdateformatter.com</a>ï¼Œä½ å¯ä»¥æŸ¥çœ‹å„ç§æ—¥æœŸæ ¼å¼çš„å­—ç¬¦ä¸²è¡¨ç¤ºã€‚</p>
</blockquote>
<p>JSON æ²¡æœ‰æ•°æ®ç±»å‹è¡¨ç¤ºæ—¥æœŸæ ¼å¼ï¼Œå› æ­¤éœ€è¦å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å¯¹åºåˆ—åŒ–è¿›è¡Œçº¦å®šã€‚</p>
<p>JSONDecoderæä¾›äº†ä¸€ä¸ªæšä¸¾ç±»å‹æ¥å¤„ç†æ—¥æœŸæ ¼å¼ï¼Œå…¶å®šä¹‰å¦‚ä¸‹:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/// The strategy to use for decoding `Date` values.</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">enum</span> <span class="title">DateDecodingStrategy</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="comment">/// Defer to `Date` for decoding. This is the default strategy.</span></div><div class="line">    <span class="keyword">case</span> deferredToDate</div><div class="line"></div><div class="line">    <span class="comment">/// Decode the `Date` as a UNIX timestamp from a JSON number.</span></div><div class="line">    <span class="keyword">case</span> secondsSince1970</div><div class="line"></div><div class="line">    <span class="comment">/// Decode the `Date` as UNIX millisecond timestamp from a JSON number.</span></div><div class="line">    <span class="keyword">case</span> millisecondsSince1970</div><div class="line"></div><div class="line">    <span class="comment">/// Decode the `Date` as an ISO-8601-formatted string (in RFC 3339 format).</span></div><div class="line">    <span class="keyword">case</span> iso8601</div><div class="line"></div><div class="line">    <span class="comment">/// Decode the `Date` as a string parsed by the given formatter.</span></div><div class="line">    <span class="keyword">case</span> formatted(<span class="type">DateFormatter</span>)</div><div class="line"></div><div class="line">    <span class="comment">/// Decode the `Date` as a custom value decoded by the given closure.</span></div><div class="line">    <span class="keyword">case</span> custom((<span class="type">Decoder</span>) <span class="keyword">throws</span> -&gt; <span class="type">Date</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°JSONDecoderå†…ç½®äº†å‡ ç§æ—¥æœŸå¤„ç†æ–¹å¼ï¼Œå‰å››ç§æ²¡ä»€ä¹ˆå¯è¯´çš„ï¼Œç›´æ¥èµ‹å€¼æ‹¿æ¥ç”¨å°±è¡Œäº†ï¼Œç€é‡è¯´ä¸€ä¸‹<code>.formatted(DateFormatter)</code>å’Œ<code>.custom((Decoder) throws -&gt; Date)</code>ã€‚</p>
<ul>
<li>.formatted(DateFormatter)</li>
</ul>
<p>å½“æœåŠ¡å™¨è¿”å›çš„æ˜¯ä¸€ä¸ªéæ ‡å‡†æ ¼å¼çš„æ—¥æœŸå­—ç¬¦ä¸²æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥æä¾›ä¸€ä¸ª<code>DateFormatter</code>æ¥æŒ‡å®šæ—¥æœŸæ ¼å¼</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> decoder = <span class="type">JSONDecoder</span>()</div><div class="line"><span class="keyword">let</span> formatter = <span class="type">DateFormatter</span>()</div><div class="line">formatter.dateFormat = <span class="string">"yyyy-MM-dd HH:mm:ss"</span></div><div class="line">formatter.timeZone = <span class="type">TimeZone</span>(abbreviation: <span class="string">"UTC"</span>)</div><div class="line">decoder.dateDecodingStrategy = .formatted(formatter)</div></pre></td></tr></table></figure>
<ul>
<li>.custom((Decoder) throws -&gt; Date)</li>
</ul>
<p>å½“DateFormatterä¹Ÿä¸èƒ½æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±æŒ‡å®šå¦‚ä½•è§£æã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> decoder = <span class="type">JSONDecoder</span>()</div><div class="line">decoder.dateDecodingStrategy = .custom(&#123; (decoder) -&gt; <span class="type">Date</span> <span class="keyword">in</span></div><div class="line">    <span class="keyword">let</span> container = <span class="keyword">try</span> decoder.singleValueContainer()</div><div class="line">    <span class="keyword">if</span> <span class="keyword">let</span> str = <span class="keyword">try</span>? container.decode(<span class="type">String</span>.<span class="keyword">self</span>) &#123;</div><div class="line">        <span class="comment">// å¦‚æœ‰å¿…è¦,è¿™é‡Œè¿˜å¯ä»¥åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦ä¸ºæ—¶é—´æˆ³,æœ€ç»ˆè½¬æ¢æˆDate</span></div><div class="line">        <span class="keyword">let</span> formatter = <span class="type">DateFormatter</span>()</div><div class="line">        formatter.dateFormat = <span class="string">"yyyy-MM-dd HH:mm:ss"</span></div><div class="line">        formatter.timeZone = <span class="type">TimeZone</span>(abbreviation: <span class="string">"UTC"</span>)</div><div class="line">        <span class="keyword">if</span> <span class="keyword">let</span> date = formatter.date(from: str) &#123;</div><div class="line">            <span class="keyword">return</span> date</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> <span class="keyword">let</span> double = <span class="keyword">try</span>? container.decode(<span class="type">Double</span>.<span class="keyword">self</span>) &#123;</div><div class="line">        <span class="comment">// å¯æ ¹æ®æœåŠ¡å™¨è¿”å›çš„æ—¶é—´æˆ³æ˜¯ç›¸å¯¹äº1970.1.1 00:00:00è¿˜æ˜¯2001.1.1 00:00:00è¿›è¡Œç›¸åº”çš„è½¬æ¢</span></div><div class="line">        <span class="keyword">return</span> <span class="type">Date</span>(timeIntervalSinceReferenceDate: double)</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">throw</span> <span class="type">DecodingError</span>.dataCorruptedError(<span class="keyword">in</span>: container, debugDescription: <span class="string">"Cannot decode date."</span>)</div><div class="line">&#125;)</div><div class="line">...</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å¯ä»¥è¿›ä¸€æ­¥ä¼˜åŒ–ä»£ç ï¼Œé€šè¿‡ç»™<code>JSONDecoder.DateDecodingStrategy</code>æ‰©å±•ä¸€ä¸ª<code>customDateConvert()</code>æ–¹æ³•ï¼Œä¹‹ååœ¨å¤šä¸ªåœ°æ–¹è¿›è¡Œæ—¥æœŸçš„è½¬æ¢ä¹Ÿå°†å˜å¾—å¾ˆç®€å•ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">decoder.dateDecodingStrategy = .customDateConvert()</div></pre></td></tr></table></figure>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">JSONDecoder</span>.<span class="title">DateDecodingStrategy</span> </span>&#123;</div><div class="line">    </div><div class="line">    <span class="comment">/// è‡ªå®šä¹‰è§£ææ—¥æœŸ</span></div><div class="line">    <span class="comment">/// ä½¿ç”¨æ–¹å¼: JSONDecoder().dateDecodingStrategy = .customDateConvert()</span></div><div class="line">    <span class="comment">///</span></div><div class="line">    <span class="comment">/// - Returns: .custom((Decoder) -&gt; Date)</span></div><div class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">customDateConvert</span><span class="params">()</span></span> -&gt; <span class="type">JSONDecoder</span>.<span class="type">DateDecodingStrategy</span> &#123;</div><div class="line">        <span class="keyword">return</span> .custom(&#123; (decoder) -&gt; <span class="type">Date</span> <span class="keyword">in</span></div><div class="line">            <span class="keyword">let</span> container = <span class="keyword">try</span> decoder.singleValueContainer()</div><div class="line">            <span class="keyword">if</span> <span class="keyword">let</span> str = <span class="keyword">try</span>? container.decode(<span class="type">String</span>.<span class="keyword">self</span>) &#123;</div><div class="line">                <span class="keyword">let</span> formatter = <span class="type">DateFormatter</span>()</div><div class="line">                formatter.timeZone = <span class="type">TimeZone</span>(abbreviation: <span class="string">"UTC"</span>)</div><div class="line">                <span class="keyword">for</span> dateFormat <span class="keyword">in</span> [<span class="string">"yyyy-MM-dd HH:mm:ss"</span>, <span class="string">"yyyy-MM-dd"</span>] &#123;</div><div class="line">                    formatter.dateFormat = dateFormat</div><div class="line">                    <span class="keyword">guard</span> <span class="keyword">let</span> date = formatter.date(from: str) <span class="keyword">else</span> &#123; <span class="keyword">continue</span> &#125;</div><div class="line">                    <span class="keyword">return</span> date</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> <span class="keyword">let</span> double = <span class="keyword">try</span>? container.decode(<span class="type">Double</span>.<span class="keyword">self</span>) &#123;</div><div class="line">                <span class="comment">// æ ¹æ®æœåŠ¡å™¨è¿”å›çš„æ—¶é—´æˆ³æ˜¯ç›¸å¯¹äº1970.1.1 00:00:00è¿˜æ˜¯2001.1.1 00:00:00è¿›è¡Œç›¸åº”çš„è½¬æ¢</span></div><div class="line">                <span class="keyword">return</span> <span class="type">Date</span>(timeIntervalSince1970: double)</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">throw</span> <span class="type">DecodingError</span>.dataCorruptedError(<span class="keyword">in</span>: container, debugDescription: <span class="string">"Cannot decode date."</span>)</div><div class="line">        &#125;)</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="è‡ªå®šä¹‰è§£æ"><a href="#è‡ªå®šä¹‰è§£æ" class="headerlink" title="è‡ªå®šä¹‰è§£æ"></a>è‡ªå®šä¹‰è§£æ</h2><p>ç†æƒ³æƒ…å†µä¸‹æˆ‘ä»¬å½“ç„¶ä¸éœ€è¦è‡ªå·±å®ç°<code>init(from decoder: Decoder) throws</code>æ–¹æ³•ï¼Œä½†æ˜¯æ€»æœ‰ä¸€äº›ç‰¹æ®Šæƒ…å†µï¼Œæˆ–è€…è¯´æ˜¯ç»™ä»£ç å¢åŠ å®¹é”™æœºåˆ¶ï¼Œæˆ‘ä»¬ä¸å¾—ä¸å®ç°è¯¥æ–¹æ³•ï¼Œè‡ªå·±å®ç°è§£ç æ“ä½œã€‚</p>
<p>ç¼–è¯‘å™¨çš„é»˜è®¤å®ç°ä¸­ï¼Œéƒ½æ˜¯ä½¿ç”¨<code>public func decode&lt;T&gt;(_ type: T.Type, forKey key: KeyedDecodingContainer.Key) throws -&gt; T where T : Decodable</code>æ–¹æ³•è¿›è¡Œè§£ç çš„ã€‚</p>
<p><strong><em>é»˜è®¤å®ç°æœ‰ä¸€å®šçš„å±€é™æ€§</em></strong></p>
<ul>
<li><p>æˆ‘ä»¬åœ¨ä¸Šé¢ä¸­å®šä¹‰çš„genderå±æ€§ï¼Œå¦‚æœJSONæ•°æ®ä¸­å¹¶ä¸å­˜åœ¨genderè¿™ä¸ªKeyæ—¶åˆ™ä¼šæŠ›å‡ºä¸‹é¢çš„å¼‚å¸¸ä¿¡æ¯:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">keyNotFound(ETNavBarTransparentDemo.Person.(CodingKeys in _34A23078E52B5E180CB78F393D171183).gender, Swift.DecodingError.Context(codingPath: [], debugDescription: &quot;No value associated with key gender (\&quot;gender\&quot;).&quot;, underlyingError: nil))</div></pre></td></tr></table></figure>
</li>
<li><p>å¦‚æœModelä¸­å±æ€§çš„ç±»å‹æ˜¯Intå‹ï¼Œä½†æ˜¯JSONä¸­å´æ˜¯Stringç±»å‹çš„æ•°å­—ï¼Œé‚£ä¹Ÿä¼šæŠ›å‡ºå¼‚å¸¸:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">typeMismatch(Swift.Int, Swift.DecodingError.Context(codingPath: [ETNavBarTransparentDemo.Person.(CodingKeys in _34A23078E52B5E180CB78F393D171183).age], debugDescription: &quot;Expected to decode Int but found a string/data instead.&quot;, underlyingError: nil))</div></pre></td></tr></table></figure>
</li>
<li><p>Boolç±»å‹ï¼Œåªèƒ½å¤„ç†true/falseï¼Œä¸èƒ½å¤„ç†å­—ç¬¦ä¸²çš„â€trueâ€/â€œfalseâ€ä»¥åŠæ•°å­—0/1</p>
</li>
<li><p>Intå’ŒDoubleçš„åŒºåˆ«ï¼Œå½“JSONä¸­çš„valueä¸º88.0æ—¶ï¼ŒIntå’ŒDoubleå‡å¯ä»¥è§£ç ï¼Œä½†æ˜¯å¦‚æœvalueä¸º88.01æ—¶ï¼ŒIntè§£ç å¤±è´¥ï¼ŒæŠ›å‡ºtypeMismatchå¼‚å¸¸ä¿¡æ¯</p>
</li>
</ul>
<p>å¯¹äºä»¥ä¸Šæƒ…å†µï¼Œå¦‚æœä½ ä»¬Appè§‰å¾—æ— æ‰€è°“ï¼Œé‚£å°±æ²¡ä»€ä¹ˆäº†ï¼›ä½†æ˜¯å¦‚æœä½ æƒ³è‡ªå·±å¤„ç†è¿™äº›æƒ…å†µï¼Œä¿è¯èƒ½å¤Ÿæ­£å¸¸çš„è§£ç JSONæ•°æ®ï¼Œé‚£ä½ å°±åªèƒ½è‡ªè¡Œå®ç°<code>init(from decoder: Decoder) throws</code>äº†ã€‚</p>
<p>è‡ªå®šä¹‰è§£æ:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">DataModel</span>: <span class="title">Codable</span> </span>&#123;</div><div class="line">    <span class="class"><span class="keyword">enum</span> <span class="title">CodingKeys</span>: <span class="title">String</span>, <span class="title">CodingKey</span> </span>&#123;</div><div class="line">        <span class="keyword">case</span> id, flag</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">var</span> id: <span class="type">Int</span></div><div class="line">    <span class="keyword">var</span> flag: <span class="type">Bool</span></div><div class="line">    </div><div class="line">    <span class="keyword">init</span>(from decoder: <span class="type">Decoder</span>) <span class="keyword">throws</span> &#123;</div><div class="line">        <span class="keyword">let</span> container = <span class="keyword">try</span> decoder.container(keyedBy: <span class="type">CodingKeys</span>.<span class="keyword">self</span>)</div><div class="line">        id = (<span class="keyword">try</span> container.decodeIntIfPresent(.id)) ?? <span class="number">0</span></div><div class="line">        flag = (<span class="keyword">try</span> container.decodeBoolIfPresent(.flag)) ?? <span class="literal">true</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>é’ˆå¯¹ä¸Šé¢çš„æƒ…å†µï¼Œæˆ‘ç»™KeyedDecodingContaineræ‰©å±•äº†å‡ ä¸ªæ–¹æ³•ï¼Œå·²å¯æ»¡è¶³ç›®å‰é¡¹ç›®çš„éœ€æ±‚ï¼ŒåæœŸå¯è§†æƒ…å†µå†æ–°å¢:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// MARK: - å¼ºåˆ¶è§£ç ,å¦‚æœkeyä¸å­˜åœ¨åˆ™æŠ›å‡ºå¼‚å¸¸`DecodingError.keyNotFound`</span></div><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">KeyedDecodingContainer</span> </span>&#123;</div><div class="line">    </div><div class="line">    <span class="comment">/// è§£ç CGFloat</span></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">decodeCGFloat</span><span class="params">(<span class="number">_</span> key: K)</span></span> <span class="keyword">throws</span> -&gt; <span class="type">CGFloat</span> &#123;</div><div class="line">        <span class="keyword">do</span> &#123;</div><div class="line">            <span class="keyword">let</span> d = <span class="keyword">try</span> decodeDouble(key)</div><div class="line">            <span class="keyword">return</span> <span class="type">CGFloat</span>(d)</div><div class="line">        &#125; <span class="keyword">catch</span> &#123;</div><div class="line">            <span class="keyword">throw</span> error</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">/// è§£ç Double</span></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">decodeDouble</span><span class="params">(<span class="number">_</span> key: K)</span></span> <span class="keyword">throws</span> -&gt; <span class="type">Double</span> &#123;</div><div class="line">        <span class="keyword">do</span> &#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">try</span> decode(<span class="type">Double</span>.<span class="keyword">self</span>, forKey: key)</div><div class="line">        &#125; <span class="keyword">catch</span> &#123;</div><div class="line">            <span class="keyword">if</span> <span class="keyword">let</span> i = <span class="keyword">try</span>? decode(<span class="type">Int</span>.<span class="keyword">self</span>, forKey: key) &#123;</div><div class="line">                <span class="keyword">return</span> <span class="type">Double</span>(i)</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> <span class="keyword">let</span> s = <span class="keyword">try</span>? decode(<span class="type">String</span>.<span class="keyword">self</span>, forKey: key), <span class="keyword">let</span> d = <span class="type">Double</span>(s) &#123;</div><div class="line">                <span class="keyword">return</span> d</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> <span class="keyword">let</span> b = <span class="keyword">try</span>? decode(<span class="type">Bool</span>.<span class="keyword">self</span>, forKey: key) &#123;</div><div class="line">                <span class="keyword">return</span> b ? <span class="number">1.0</span> : <span class="number">0.0</span></div><div class="line">            &#125;</div><div class="line">            <span class="keyword">throw</span> error</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">/// è§£ç Int</span></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">decodeInt</span><span class="params">(<span class="number">_</span> key: K)</span></span> <span class="keyword">throws</span> -&gt; <span class="type">Int</span> &#123;</div><div class="line">        <span class="keyword">do</span> &#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">try</span> decode(<span class="type">Int</span>.<span class="keyword">self</span>, forKey: key)</div><div class="line">        &#125; <span class="keyword">catch</span> &#123;</div><div class="line">            <span class="keyword">if</span> <span class="keyword">let</span> d = <span class="keyword">try</span>? decode(<span class="type">Double</span>.<span class="keyword">self</span>, forKey: key) &#123;</div><div class="line">                <span class="keyword">return</span> <span class="type">Int</span>(d)</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> <span class="keyword">let</span> s = <span class="keyword">try</span>? decode(<span class="type">String</span>.<span class="keyword">self</span>, forKey: key), <span class="keyword">let</span> i = <span class="type">Int</span>(s) &#123;</div><div class="line">                <span class="keyword">return</span> i</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> <span class="keyword">let</span> b = <span class="keyword">try</span>? decode(<span class="type">Bool</span>.<span class="keyword">self</span>, forKey: key) &#123;</div><div class="line">                <span class="keyword">return</span> b ? <span class="number">1</span> : <span class="number">0</span></div><div class="line">            &#125;</div><div class="line">            <span class="keyword">throw</span> error</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">/// è§£ç String</span></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">decodeString</span><span class="params">(<span class="number">_</span> key: K)</span></span> <span class="keyword">throws</span> -&gt; <span class="type">String</span> &#123;</div><div class="line">        <span class="keyword">do</span> &#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">try</span> decode(<span class="type">String</span>.<span class="keyword">self</span>, forKey: key)</div><div class="line">        &#125; <span class="keyword">catch</span> &#123;</div><div class="line">            <span class="keyword">if</span> <span class="keyword">let</span> i = <span class="keyword">try</span>? decode(<span class="type">Int</span>.<span class="keyword">self</span>, forKey: key) &#123;</div><div class="line">                <span class="keyword">return</span> <span class="type">String</span>(i)</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> <span class="keyword">let</span> d = <span class="keyword">try</span>? decode(<span class="type">Double</span>.<span class="keyword">self</span>, forKey: key) &#123;</div><div class="line">                <span class="keyword">return</span> <span class="type">String</span>(d)</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> <span class="keyword">let</span> b = <span class="keyword">try</span>? decode(<span class="type">Bool</span>.<span class="keyword">self</span>, forKey: key) &#123;</div><div class="line">                <span class="keyword">return</span> b ? <span class="string">"true"</span> : <span class="string">"false"</span></div><div class="line">            &#125;</div><div class="line">            <span class="keyword">throw</span> error</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">/// è§£ç Bool</span></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">decodeBool</span><span class="params">(<span class="number">_</span> key: K)</span></span> <span class="keyword">throws</span> -&gt; <span class="type">Bool</span> &#123;</div><div class="line">        <span class="keyword">do</span> &#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">try</span> decode(<span class="type">Bool</span>.<span class="keyword">self</span>, forKey: key)</div><div class="line">        &#125; <span class="keyword">catch</span> &#123;</div><div class="line">            <span class="keyword">if</span> <span class="keyword">let</span> s = <span class="keyword">try</span>? decode(<span class="type">String</span>.<span class="keyword">self</span>, forKey: key) &#123;</div><div class="line">                <span class="keyword">if</span> s.isEmpty || s == <span class="string">"0"</span> || s.lowercased() == <span class="string">"false"</span> &#123;</div><div class="line">                    <span class="keyword">return</span> <span class="literal">false</span></div><div class="line">                &#125;</div><div class="line">                <span class="keyword">return</span> <span class="literal">true</span></div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> <span class="keyword">let</span> i = <span class="keyword">try</span>? decode(<span class="type">Int</span>.<span class="keyword">self</span>, forKey: key) &#123;</div><div class="line">                <span class="keyword">return</span> (i == <span class="number">0</span>) ? <span class="literal">false</span> : <span class="literal">true</span></div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> <span class="keyword">let</span> d = <span class="keyword">try</span>? decode(<span class="type">Double</span>.<span class="keyword">self</span>, forKey: key) &#123;</div><div class="line">                <span class="keyword">return</span> (d == <span class="number">0.0</span>) ? <span class="literal">false</span> : <span class="literal">true</span></div><div class="line">            &#125;</div><div class="line">            <span class="keyword">throw</span> error</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">/// è§£ç Date</span></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">decodeDate</span><span class="params">(<span class="number">_</span> key: K)</span></span> <span class="keyword">throws</span> -&gt; <span class="type">Date</span> &#123;</div><div class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> date = <span class="keyword">try</span> decodeDateIfPresent(key) <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">let</span> context = <span class="type">DecodingError</span>.<span class="type">Context</span>(codingPath: [key], debugDescription: <span class="string">"No value associated with key `<span class="subst">\(key)</span>`"</span>)</div><div class="line">            <span class="keyword">throw</span> <span class="type">DecodingError</span>.keyNotFound(key, context)</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> date</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// MARK: - å¿½ç•¥`DecodingError.keyNotFound`å¼‚å¸¸ä¿¡æ¯,å½“keyä¸å­˜åœ¨æ—¶è¿”å›`nil`</span></div><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">KeyedDecodingContainer</span> </span>&#123;</div><div class="line">    </div><div class="line">    <span class="comment">/// è§£ç CGFloatæ•°æ®</span></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">decodeCGFloatIfPresent</span><span class="params">(<span class="number">_</span> key: K)</span></span> <span class="keyword">throws</span> -&gt; <span class="type">CGFloat</span>? &#123;</div><div class="line">        <span class="keyword">if</span> <span class="keyword">let</span> d = <span class="keyword">try</span> decodeDoubleIfPresent(key) &#123;</div><div class="line">            <span class="keyword">return</span> <span class="type">CGFloat</span>(d)</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="literal">nil</span></div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">/// è§£ç Doubleæ•°æ®</span></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">decodeDoubleIfPresent</span><span class="params">(<span class="number">_</span> key: K)</span></span> <span class="keyword">throws</span> -&gt; <span class="type">Double</span>? &#123;</div><div class="line">        <span class="keyword">do</span> &#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">try</span> decodeIfPresent(<span class="type">Double</span>.<span class="keyword">self</span>, forKey: key)</div><div class="line">        &#125; <span class="keyword">catch</span> &#123;</div><div class="line">            <span class="comment">// Int -&gt; Double</span></div><div class="line">            <span class="keyword">do</span> &#123;</div><div class="line">                <span class="keyword">if</span> <span class="keyword">let</span> i = <span class="keyword">try</span> decodeIfPresent(<span class="type">Int</span>.<span class="keyword">self</span>, forKey: key) &#123;</div><div class="line">                    <span class="keyword">return</span> <span class="type">Double</span>(i)</div><div class="line">                &#125;</div><div class="line">            &#125; <span class="keyword">catch</span> &#123;&#125;</div><div class="line">            <span class="comment">// String -&gt; Double</span></div><div class="line">            <span class="keyword">do</span> &#123;</div><div class="line">                <span class="keyword">if</span> <span class="keyword">let</span> s = <span class="keyword">try</span> decodeIfPresent(<span class="type">String</span>.<span class="keyword">self</span>, forKey: key) &#123;</div><div class="line">                    <span class="keyword">return</span> <span class="type">Double</span>(s)</div><div class="line">                &#125;</div><div class="line">            &#125; <span class="keyword">catch</span> &#123;&#125;</div><div class="line">            <span class="comment">// Bool -&gt; Double</span></div><div class="line">            <span class="keyword">do</span> &#123;</div><div class="line">                <span class="keyword">if</span> <span class="keyword">let</span> b = <span class="keyword">try</span> decodeIfPresent(<span class="type">Bool</span>.<span class="keyword">self</span>, forKey: key) &#123;</div><div class="line">                    <span class="keyword">return</span> b ? <span class="number">1.0</span> : <span class="number">0.0</span></div><div class="line">                &#125;</div><div class="line">            &#125; <span class="keyword">catch</span> &#123;&#125;</div><div class="line">            </div><div class="line">            <span class="comment">// failure</span></div><div class="line">            <span class="keyword">throw</span> error</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">/// è§£ç Intæ•°æ®</span></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">decodeIntIfPresent</span><span class="params">(<span class="number">_</span> key: K)</span></span> <span class="keyword">throws</span> -&gt; <span class="type">Int</span>? &#123;</div><div class="line">        <span class="keyword">do</span> &#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">try</span> decodeIfPresent(<span class="type">Int</span>.<span class="keyword">self</span>, forKey: key)</div><div class="line">        &#125; <span class="keyword">catch</span> &#123;</div><div class="line">            <span class="comment">// Double -&gt; Int</span></div><div class="line">            <span class="keyword">do</span> &#123;</div><div class="line">                <span class="keyword">if</span> <span class="keyword">let</span> d = <span class="keyword">try</span> decodeIfPresent(<span class="type">Double</span>.<span class="keyword">self</span>, forKey: key) &#123;</div><div class="line">                    <span class="keyword">return</span> <span class="type">Int</span>(d)</div><div class="line">                &#125;</div><div class="line">            &#125; <span class="keyword">catch</span> &#123;&#125;</div><div class="line">            <span class="comment">// String -&gt; Int</span></div><div class="line">            <span class="keyword">do</span> &#123;</div><div class="line">                <span class="keyword">if</span> <span class="keyword">let</span> s = <span class="keyword">try</span> decodeIfPresent(<span class="type">String</span>.<span class="keyword">self</span>, forKey: key) &#123;</div><div class="line">                    <span class="keyword">return</span> <span class="type">Int</span>(s)</div><div class="line">                &#125;</div><div class="line">            &#125; <span class="keyword">catch</span> &#123;&#125;</div><div class="line">            <span class="comment">// Bool -&gt; Int</span></div><div class="line">            <span class="keyword">do</span> &#123;</div><div class="line">                <span class="keyword">if</span> <span class="keyword">let</span> b = <span class="keyword">try</span> decodeIfPresent(<span class="type">Bool</span>.<span class="keyword">self</span>, forKey: key) &#123;</div><div class="line">                    <span class="keyword">return</span> b ? <span class="number">1</span> : <span class="number">0</span></div><div class="line">                &#125;</div><div class="line">            &#125; <span class="keyword">catch</span> &#123;&#125;</div><div class="line">            <span class="comment">// decode failure.</span></div><div class="line">            <span class="keyword">throw</span> error</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">/// è§£ç Stringæ•°æ®</span></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">decodeStringIfPresent</span><span class="params">(<span class="number">_</span> key: K)</span></span> <span class="keyword">throws</span> -&gt; <span class="type">String</span>? &#123;</div><div class="line">        <span class="keyword">do</span> &#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">try</span> decodeIfPresent(<span class="type">String</span>.<span class="keyword">self</span>, forKey: key)</div><div class="line">        &#125; <span class="keyword">catch</span> &#123;</div><div class="line">            <span class="comment">// Int -&gt; String</span></div><div class="line">            <span class="keyword">do</span> &#123;</div><div class="line">                <span class="keyword">if</span> <span class="keyword">let</span> i = <span class="keyword">try</span> decodeIfPresent(<span class="type">Int</span>.<span class="keyword">self</span>, forKey: key) &#123;</div><div class="line">                    <span class="keyword">return</span> <span class="type">String</span>(i)</div><div class="line">                &#125;</div><div class="line">            &#125; <span class="keyword">catch</span> &#123;&#125;</div><div class="line">            <span class="comment">// Double -&gt; String</span></div><div class="line">            <span class="keyword">do</span> &#123;</div><div class="line">                <span class="keyword">if</span> <span class="keyword">let</span> d = <span class="keyword">try</span> decodeIfPresent(<span class="type">Double</span>.<span class="keyword">self</span>, forKey: key) &#123;</div><div class="line">                    <span class="keyword">return</span> <span class="type">String</span>(d)</div><div class="line">                &#125;</div><div class="line">            &#125; <span class="keyword">catch</span> &#123;&#125;</div><div class="line">            <span class="comment">// Bool -&gt; String</span></div><div class="line">            <span class="keyword">do</span> &#123;</div><div class="line">                <span class="keyword">if</span> <span class="keyword">let</span> b = <span class="keyword">try</span> decodeIfPresent(<span class="type">Bool</span>.<span class="keyword">self</span>, forKey: key) &#123;</div><div class="line">                    <span class="keyword">return</span> b ? <span class="string">"true"</span> : <span class="string">"false"</span></div><div class="line">                &#125;</div><div class="line">            &#125; <span class="keyword">catch</span> &#123;&#125;</div><div class="line">            <span class="comment">// decode failure.</span></div><div class="line">            <span class="keyword">throw</span> error</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">/// è§£ç Boolæ•°æ®</span></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">decodeBoolIfPresent</span><span class="params">(<span class="number">_</span> key: K)</span></span> <span class="keyword">throws</span> -&gt; <span class="type">Bool</span>? &#123;</div><div class="line">        <span class="keyword">do</span> &#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">try</span> decodeIfPresent(<span class="type">Bool</span>.<span class="keyword">self</span>, forKey: key)</div><div class="line">        &#125; <span class="keyword">catch</span> &#123;</div><div class="line">            <span class="comment">// String -&gt; Bool</span></div><div class="line">            <span class="keyword">do</span> &#123;</div><div class="line">                <span class="keyword">if</span> <span class="keyword">let</span> s = <span class="keyword">try</span> decodeIfPresent(<span class="type">String</span>.<span class="keyword">self</span>, forKey: key) &#123;</div><div class="line">                    <span class="keyword">if</span> s.isEmpty || s == <span class="string">"0"</span> || s.lowercased() == <span class="string">"false"</span> &#123;</div><div class="line">                        <span class="keyword">return</span> <span class="literal">false</span></div><div class="line">                    &#125;</div><div class="line">                    <span class="keyword">return</span> <span class="literal">true</span></div><div class="line">                &#125;</div><div class="line">            &#125; <span class="keyword">catch</span> &#123;&#125;</div><div class="line">            <span class="comment">// Int -&gt; Bool</span></div><div class="line">            <span class="keyword">do</span> &#123;</div><div class="line">                <span class="keyword">if</span> <span class="keyword">let</span> i = <span class="keyword">try</span> decodeIfPresent(<span class="type">Int</span>.<span class="keyword">self</span>, forKey: key) &#123;</div><div class="line">                    <span class="keyword">return</span> (i == <span class="number">0</span>) ? <span class="literal">false</span> : <span class="literal">true</span></div><div class="line">                &#125;</div><div class="line">            &#125; <span class="keyword">catch</span> &#123;&#125;</div><div class="line">            <span class="comment">// Double -&gt; Bool</span></div><div class="line">            <span class="keyword">do</span> &#123;</div><div class="line">                <span class="keyword">if</span> <span class="keyword">let</span> d = <span class="keyword">try</span> decodeIfPresent(<span class="type">Double</span>.<span class="keyword">self</span>, forKey: key) &#123;</div><div class="line">                    <span class="keyword">return</span> (d == <span class="number">0.0</span>) ? <span class="literal">false</span> : <span class="literal">true</span></div><div class="line">                &#125;</div><div class="line">            &#125; <span class="keyword">catch</span> &#123;&#125;</div><div class="line">            <span class="comment">// decode failure.</span></div><div class="line">            <span class="keyword">throw</span> error</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">/// è§£ç CGSizeæ•°æ®</span></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">decodeCGSizeIfPresent</span><span class="params">(<span class="number">_</span> key: K)</span></span> <span class="keyword">throws</span> -&gt; <span class="type">CGSize</span>? &#123;</div><div class="line">        <span class="keyword">do</span> &#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">try</span> decodeIfPresent(<span class="type">CGSize</span>.<span class="keyword">self</span>, forKey: key)</div><div class="line">        &#125; <span class="keyword">catch</span> &#123;</div><div class="line">            <span class="keyword">do</span> &#123;</div><div class="line">                <span class="keyword">if</span> <span class="keyword">let</span> s = <span class="keyword">try</span> decodeIfPresent(<span class="type">String</span>.<span class="keyword">self</span>, forKey: key) &#123;</div><div class="line">                    <span class="comment">// ä¾‹: å®½xé«˜ å®½,é«˜ å®½Xé«˜</span></div><div class="line">                    <span class="keyword">for</span> seprator <span class="keyword">in</span> [<span class="string">"x"</span>, <span class="string">","</span>, <span class="string">"X"</span>] &#123;</div><div class="line">                        <span class="keyword">let</span> array = s.components(separatedBy: seprator)</div><div class="line">                        <span class="keyword">if</span> array.<span class="built_in">count</span> == <span class="number">2</span> &#123;</div><div class="line">                            <span class="keyword">if</span> <span class="keyword">let</span> w = <span class="type">Double</span>(array.first!), <span class="keyword">let</span> h = <span class="type">Double</span>(array.last!) &#123;</div><div class="line">                                <span class="keyword">return</span> <span class="type">CGSize</span>(width: w, height: h)</div><div class="line">                            &#125;</div><div class="line">                        &#125;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125; <span class="keyword">catch</span> &#123;&#125;</div><div class="line">            <span class="keyword">throw</span> error</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">/// è§£ç Date</span></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">decodeDateIfPresent</span><span class="params">(<span class="number">_</span> key: K)</span></span> <span class="keyword">throws</span> -&gt; <span class="type">Date</span>? &#123;</div><div class="line">        <span class="keyword">do</span> &#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">try</span> decodeIfPresent(<span class="type">Date</span>.<span class="keyword">self</span>, forKey: key)</div><div class="line">        &#125; <span class="keyword">catch</span> &#123;</div><div class="line">            <span class="keyword">if</span> <span class="keyword">let</span> s = <span class="keyword">try</span>? decode(<span class="type">String</span>.<span class="keyword">self</span>, forKey: key) &#123;</div><div class="line">                <span class="keyword">let</span> formatter = <span class="type">DateFormatter</span>()</div><div class="line">                formatter.timeZone = <span class="type">TimeZone</span>(abbreviation: <span class="string">"UTC"</span>)</div><div class="line">                <span class="keyword">for</span> dateFormat <span class="keyword">in</span> [<span class="string">"yyyy-MM-dd HH:mm:ss"</span>, <span class="string">"yyyy-MM-dd"</span>] &#123;</div><div class="line">                    formatter.dateFormat = dateFormat</div><div class="line">                    <span class="keyword">guard</span> <span class="keyword">let</span> date = formatter.date(from: s) <span class="keyword">else</span> &#123; <span class="keyword">continue</span> &#125;</div><div class="line">                    <span class="keyword">return</span> date</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">throw</span> error</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æœ‰äº†è¿™äº›æ‰©å±•æ–¹æ³•ï¼Œæˆ‘ä»¬å°±äº‹åŠåŠŸå€äº†ã€‚</p>
<h2 id="æœ‰è¶£çš„å‘ç°"><a href="#æœ‰è¶£çš„å‘ç°" class="headerlink" title="æœ‰è¶£çš„å‘ç°"></a>æœ‰è¶£çš„å‘ç°</h2><p>å‰ææ¡ä»¶:</p>
<ul>
<li>å®šä¹‰äº†<code>JSONDecoder.DateDecodingStrategy</code>çš„<code>customDateConvert()</code>æ‰©å±•æ–¹æ³•</li>
<li>å®šä¹‰äº†<code>KeyedDecodingContainer</code>çš„æ‰©å±•æ–¹æ³•<code>decodeDate(_:)</code>å’Œ<code>decodeDateIfPresent(_:)</code></li>
</ul>
<p>ä¼ªä»£ç (è¯¦ç»†ä»£ç è¯·çœ‹ä¸Šé¢):<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">JSONDecoder</span>.<span class="title">DateDecodingStrategy</span> </span>&#123;</div><div class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">customDateConvert</span><span class="params">()</span></span> -&gt; <span class="type">JSONDecoder</span>.<span class="type">DateDecodingStrategy</span> &#123;</div><div class="line">        ...</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">KeyedDecodingContainer</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">decodeDate</span><span class="params">(<span class="number">_</span> key: K)</span></span> <span class="keyword">throws</span> -&gt; <span class="type">Date</span> &#123;...&#125;</div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">decodeDateIfPresent</span><span class="params">(<span class="number">_</span> key: K)</span></span> <span class="keyword">throws</span> -&gt; <span class="type">Date</span>? &#123;</div><div class="line">        <span class="keyword">do</span> &#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">try</span> decodeIfPresent(<span class="type">Date</span>.<span class="keyword">self</span>, forKey: key)</div><div class="line">        &#125; <span class="keyword">catch</span> &#123;...&#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>ä¸‹é¢æ˜¯æµ‹è¯•ä»£ç :<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">DataModel</span>: <span class="title">Codable</span> </span>&#123;</div><div class="line">    <span class="keyword">var</span> time: <span class="type">Date</span></div><div class="line">    </div><div class="line">    <span class="keyword">init</span>(from decoder: <span class="type">Decoder</span>) <span class="keyword">throws</span> &#123;</div><div class="line">        <span class="keyword">let</span> container = <span class="keyword">try</span> decoder.container(keyedBy: <span class="type">CodingKeys</span>.<span class="keyword">self</span>)</div><div class="line">        time = <span class="keyword">try</span> container.decodeDate(.time)</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">do</span> &#123;</div><div class="line">    <span class="keyword">let</span> data = <span class="string">"&#123;\"time\":\"2018-04-11 17:34:23\"&#125;"</span>.data(using: .utf8)!</div><div class="line">    <span class="keyword">let</span> decoder = <span class="type">JSONDecoder</span>()</div><div class="line">    decoder.dateDecodingStrategy = .customDateConvert()</div><div class="line">    <span class="keyword">let</span> model = <span class="keyword">try</span> decoder.decode(<span class="type">DataModel</span>.<span class="keyword">self</span>, from: data)</div><div class="line">&#125; <span class="keyword">catch</span> &#123;</div><div class="line">    <span class="built_in">print</span>(error)</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>ä»æµ‹è¯•ä»£ç ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œä¸ä»…ä»…å®ç°äº†<code>init(from:)</code>æ–¹æ³•ï¼Œå¹¶ä¸”è¿˜æŒ‡å®šäº†<code>dateDecodingStrategy</code>å±æ€§ã€‚</p>
<p>åœ¨åˆå§‹åŒ–æ–¹æ³•ä¸­æˆ‘ä»¬è°ƒç”¨äº†ä¸Šé¢çš„æ‰©å±•æ–¹æ³•<code>decodeDate(_:)</code>æ¥è·å–æ—¥æœŸæ•°æ®ï¼Œè€Œå…¶å†…éƒ¨æ˜¯é€šè¿‡è°ƒç”¨<code>decodeDateIfPresent(_:)</code>æ¥è·å–æ—¥æœŸï¼Œè¿™çœ‹ä¼¼æ­£å¸¸ï¼Œå¹¶æ²¡ä»€ä¹ˆé—®é¢˜ã€‚å…³é”®åœ¨äº<code>decodeDateIfPresent(_:)</code>ä¸­é¦–å…ˆå°è¯•é€šè¿‡ç³»ç»Ÿæ–¹æ³•å»è·å–Dateï¼Œå³<code>try decodeIfPresent(Date.self, forKey: key)</code>ï¼Œè¯¥è¡Œä»£ç ä¼šå¯¼è‡´JSONDecoderä½¿ç”¨æˆ‘ä»¬çš„<code>customDateConvert()</code>æ¥è§£ç æ—¥æœŸã€‚</p>
<p>ä¹Ÿå°±æ˜¯å½¢æˆäº†è¿™ä¹ˆä¸€æ¡è°ƒç”¨é“¾: <code>decodeDate(_:)</code> -&gt; <code>decodeDateIfPresent(_:)</code> -&gt; <code>customDateConvert()</code></p>
<h2 id="æ›´å¤šä¿¡æ¯è¯·å‚è€ƒï¼š"><a href="#æ›´å¤šä¿¡æ¯è¯·å‚è€ƒï¼š" class="headerlink" title="æ›´å¤šä¿¡æ¯è¯·å‚è€ƒï¼š"></a>æ›´å¤šä¿¡æ¯è¯·å‚è€ƒï¼š</h2><ul>
<li><a href="https://developer.apple.com/documentation/foundation/archives_and_serialization/using_json_with_custom_types" target="_blank" rel="external">Using JSON with Custom Types</a></li>
<li><a href="https://juejin.im/entry/59c9bc826fb9a00a5e35eaaa" target="_blank" rel="external">Swift4 ç»ˆæè§£ææ–¹æ¡ˆï¼šè¿›é˜¶ç¯‡</a></li>
<li><a href="https://segmentfault.com/a/1190000009929819" target="_blank" rel="external">Swift 4 JSON è§£ææŒ‡å—</a></li>
<li><a href="https://stackoverflow.com/questions/44682626/swifts-jsondecoder-with-multiple-date-formats-in-a-json-string" target="_blank" rel="external">https://stackoverflow.com/questions/44682626/swifts-jsondecoder-with-multiple-date-formats-in-a-json-string</a></li>
</ul>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2018/03/26/swift4-Codable/" class="archive-article-date">
  	<time datetime="2018-03-26T08:25:32.000Z" itemprop="datePublished"><i class="icon-clock"></i>2018-03-26</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Swift/">Swift</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li></ul>
	</div>

      

      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-iOS-SafariServices" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/03/14/iOS-SafariServices/">SafariServicesæ¡†æ¶</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>ç›¸ä¿¡å¤§å®¶åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œéƒ½ç¦»ä¸å¼€webå§ï¼Œéƒ¨åˆ†é¡µé¢è¿˜æ˜¯å¾—ç”¨ç½‘é¡µè¿›è¡Œå±•ç¤ºã€‚åœ¨iOS7å’Œä¹‹å‰æˆ‘ä»¬å¯ä»¥ç”¨UIWebViewæ¥åŠ è½½ç½‘é¡µï¼Œåœ¨iOS8 Appleä¸ºæˆ‘ä»¬å¸¦æ¥äº†WKWebView(WebKitæ¡†æ¶)ï¼Œè€Œåœ¨iOS9 Appleä¸ºæˆ‘ä»¬æä¾›äº†è¿›ä¸€æ­¥çš„å°è£…åº“SafariServicesã€‚</p>
<p>SafariServicesçš„å¯å®šåˆ¶æ€§å¾ˆå·®ï¼Œå¯ä»¥è¯´æ¯«æ— å®šåˆ¶æ€§å¯è¨€ï¼Œæˆ‘ä»¬åªèƒ½æ§åˆ¶ä¸€ä¸‹å¯¼èˆªæ å’Œåº•éƒ¨å·¥å…·æ çš„é¢œè‰²ï¼Œä»¥åŠé€šè¿‡SFSafariViewControllerDelegateå¯ä»¥æ·»åŠ è‡ªå®šçš„åˆ†äº«åŠŸèƒ½(UIActivity)ã€‚</p>
<h3 id="SFSafariViewController"><a href="#SFSafariViewController" class="headerlink" title="SFSafariViewController"></a><strong><em>SFSafariViewController</em></strong></h3><p>ä¸€ä¸ªç‰¹æ®Šçš„UIViewControllerï¼Œä¸ºæˆ‘ä»¬ä½¿ç”¨Safariçš„UIæ¡†æ¶åŠ è½½ç½‘é¡µå†…å®¹ï¼ŒåŒæ—¶è¿˜èƒ½äº«å—åˆ°Safariçš„ä¸€äº›ä¾¿åˆ©æ€§ï¼š</p>
<ul>
<li>é«˜åº¦ä¸€è‡´çš„ç”¨æˆ·ä½“éªŒæ€§</li>
<li>å’ŒSafariå…±äº«Cookie</li>
<li>å¯†ç ã€è¯ä¹¦è‡ªåŠ¨å¡«å……</li>
<li>Safarié˜…è¯»å™¨(å¯é€‰æ˜¯å¦é»˜è®¤è¿›å…¥é˜…è¯»å™¨æ¨¡å¼)</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSURL</span> *url = [<span class="built_in">NSURL</span> URLWithString:<span class="string">@"http://www.0daybug.com"</span>];</div><div class="line">SFSafariViewController *safariVC;</div><div class="line"><span class="keyword">if</span> (@available(iOS <span class="number">11.0</span>, *)) &#123;</div><div class="line">    SFSafariViewControllerConfiguration *configuration = [[SFSafariViewControllerConfiguration alloc] init];</div><div class="line">    configuration.entersReaderIfAvailable = <span class="literal">NO</span>;</div><div class="line">    configuration.barCollapsingEnabled = <span class="literal">YES</span>;</div><div class="line">    safariVC = [[SFSafariViewController alloc] initWithURL:url configuration:configuration];</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">    safariVC = [[SFSafariViewController alloc] initWithURL:url];</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span> (@available(iOS <span class="number">11.0</span>, *)) &#123;</div><div class="line">    safariVC.dismissButtonStyle = SFSafariViewControllerDismissButtonStyleClose;</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span> (@available(iOS <span class="number">10.0</span>, *)) &#123;</div><div class="line">    safariVC.preferredBarTintColor = [<span class="built_in">UIColor</span> orangeColor];</div><div class="line">    safariVC.preferredControlTintColor = [<span class="built_in">UIColor</span> redColor];</div><div class="line">&#125;</div><div class="line"><span class="comment">// [self.navigationController pushViewController:safariVC animated:true];</span></div><div class="line">[<span class="keyword">self</span> presentViewController:safariVC animated:<span class="literal">true</span> completion:<span class="literal">nil</span>];</div></pre></td></tr></table></figure>
<p>SFSafariViewControlleråœ¨pushå’Œpresentä¸Šæœ‰äº›è®¸åŒºåˆ«ã€‚</p>
<ul>
<li>pushæ–¹å¼<ol>
<li>ç‚¹å‡»å·¦ä¸Šè§’çš„æŒ‰é’®å¹¶ä¸ä¼šå…³é—­ç½‘é¡µï¼Œéœ€è¦è‡ªè¡Œå¤„ç†</li>
<li>ä¸æ”¯æŒå±å¹•å·¦ä¾§æ»‘åŠ¨è¿”å›ä¸Šä¸€é¡µçš„æ‰‹åŠ¿</li>
</ol>
</li>
<li>presentæ–¹å¼<ol>
<li>ç‚¹å‡»å·¦ä¸Šè§’æŒ‰é’®ä¼šå…³é—­ç½‘é¡µè¿”å›ä¸Šä¸€ä¸ªé¡µé¢</li>
<li>æ”¯æŒå±å¹•å·¦ä¾§æ»‘åŠ¨è¿”å›ä¸Šä¸€é¡µçš„æ‰‹åŠ¿</li>
</ol>
</li>
</ul>
<h3 id="SFSafariViewControllerConfiguration"><a href="#SFSafariViewControllerConfiguration" class="headerlink" title="SFSafariViewControllerConfiguration"></a><strong><em>SFSafariViewControllerConfiguration</em></strong></h3><p>iOS11æ–°å¢çš„é…ç½®ç±»ï¼Œç›®å‰çš„å¯é…ç½®é€‰é¡¹ä»…æœ‰ä¸¤ä¸ªï¼š</p>
<ul>
<li>entersReaderIfAvailable<ol>
<li>åœ¨å½“å‰ç½‘é¡µæ”¯æŒé˜…è¯»å™¨æ—¶æ˜¯å¦è‡ªåŠ¨è¿›å…¥é˜…è¯»å™¨æ¨¡å¼æµè§ˆç½‘é¡µ</li>
<li>é»˜è®¤NO</li>
</ol>
</li>
<li>barCollapsingEnabled<ol>
<li>å½“æ‹–åŠ¨ç½‘é¡µè¿›è¡Œæ»šåŠ¨æ—¶ï¼Œæ˜¯å¦æŠ˜å å¯¼èˆªæ å’Œéšè—åº•éƒ¨å·¥å…·æ </li>
<li>é»˜è®¤YES</li>
</ol>
</li>
</ul>
<h3 id="SSReadingList"><a href="#SSReadingList" class="headerlink" title="SSReadingList"></a><strong><em>SSReadingList</em></strong></h3><p>æ·»åŠ URLé“¾æ¥åˆ°Safariæµè§ˆå™¨çš„é˜…è¯»åˆ—è¡¨ã€‚éœ€è¦æ³¨æ„ä¸€ç‚¹çš„æ˜¯ç›¸åŒçš„URLå¯ä»¥æ·»åŠ å¤šæ¬¡ï¼Œç³»ç»Ÿå¹¶ä¸ä¼šè¿‡æ»¤ç›¸åŒçš„URLã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSURL</span> *url = [<span class="built_in">NSURL</span> URLWithString:<span class="string">@"http://www.0daybug.com"</span>];</div><div class="line">SSReadingList *readingList = [SSReadingList defaultReadingList];</div><div class="line">[readingList addReadingListItemWithURL:url title:<span class="string">@"æˆ‘çš„åšå®¢"</span> previewText:<span class="string">@"è®°å½•æ—¥å¸¸å¼€å‘ç”Ÿæ¶¯ä¸­çš„ç‚¹æ»´"</span> error:<span class="literal">nil</span>];</div></pre></td></tr></table></figure>
<h3 id="SFContentBlockerManager"><a href="#SFContentBlockerManager" class="headerlink" title="SFContentBlockerManager"></a><strong><em>SFContentBlockerManager</em></strong></h3><p>Content Blockerï¼Œæ®è¯´æ˜¯ä¸€ä¸ªBrowser Extensionä¹‹ç±»çš„ç©æ„ï¼Œå’Œå¹¿å‘Šè¿‡æ»¤çš„ä½œç”¨ç±»ä¼¼ï¼Œç›®å‰åŠŸèƒ½ä¸æ˜ï¼Œæ›´å¤šä¿¡æ¯å¯ä»¥çœ‹<a href="https://webkit.org/blog/3476/content-blockers-first-look/" target="_blank" rel="external">è¿™é‡Œ</a>ã€‚</p>
<h3 id="æ•ˆæœæ¼”ç¤º"><a href="#æ•ˆæœæ¼”ç¤º" class="headerlink" title="æ•ˆæœæ¼”ç¤º"></a>æ•ˆæœæ¼”ç¤º</h3><p><img src="/images/201802/SafariServices.gif" alt="GIF"></p>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2018/03/14/iOS-SafariServices/" class="archive-article-date">
  	<time datetime="2018-03-14T07:46:51.000Z" itemprop="datePublished"><i class="icon-clock"></i>2018-03-14</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li></ul>
	</div>

      

      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-iOS-compile-MobileVLCKit.framework" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/02/26/iOS-compile-MobileVLCKit.framework/">iOSç¼–è¯‘MobileVLCKit.framework</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="æˆ‘çš„ç¼–è¯‘ç¯å¢ƒ"><a href="#æˆ‘çš„ç¼–è¯‘ç¯å¢ƒ" class="headerlink" title="æˆ‘çš„ç¼–è¯‘ç¯å¢ƒ"></a>æˆ‘çš„ç¼–è¯‘ç¯å¢ƒ</h2><ul>
<li>macOS 10.12.6</li>
<li>Xcode9.2</li>
</ul>
<h2 id="ç¼–è¯‘MobileVLCKit-frameworké™æ€åº“"><a href="#ç¼–è¯‘MobileVLCKit-frameworké™æ€åº“" class="headerlink" title="ç¼–è¯‘MobileVLCKit.frameworké™æ€åº“"></a>ç¼–è¯‘MobileVLCKit.frameworké™æ€åº“</h2><ul>
<li><p>æŠŠæºç cloneä¸‹æ¥</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git clone https://code.videolan.org/videolan/VLCKit.git</div></pre></td></tr></table></figure>
</li>
<li><p>å¼€å§‹ç¼–è¯‘MobileVLCKit,framework</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd VLCKit</div><div class="line">./buildMobileVLCKit.sh -a all</div></pre></td></tr></table></figure>
</li>
</ul>
<p><img src="/images/201802/vlc-compile.png" alt="å›¾1"></p>
<p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œè¯´æ˜ç¼–è¯‘å®Œæˆå¹¶ä¸”æˆåŠŸäº†ã€‚æ•´ä¸ªç¼–è¯‘è¿‡ç¨‹å¼‚å¸¸ç¼“æ…¢ï¼Œåœ¨æˆ‘çš„iMacä¸Šè¶³è¶³ç¼–è¯‘äº†2ä¸ªå°æ—¶ã€‚</p>
<p><img src="/images/201802/vlc-build-directory.png" alt="å›¾2"></p>
<p>buildç›®å½•ä¸‹çš„MobileVLCKit.frameworkå°±æ˜¯æˆ‘ä»¬æ‰€éœ€çš„é™æ€åº“æ–‡ä»¶äº†ã€‚</p>
<h2 id="ç¤ºä¾‹ä»£ç "><a href="#ç¤ºä¾‹ä»£ç " class="headerlink" title="ç¤ºä¾‹ä»£ç "></a>ç¤ºä¾‹ä»£ç </h2><ul>
<li><p>æ‰“å¼€Xcodeæ–°å»ºä¸€ä¸ªé¡¹ç›®ï¼Œç„¶åæŠŠbuildç›®å½•ä¸‹çš„MobileVLCKit.frameworkæ‹–åˆ°é¡¹ç›®ä¸­ï¼Œå¹¶å¯¼å…¥ä¾èµ–åº“ï¼šï¼ˆç½‘ä¸Šæœ‰äº›åªæ˜¯è¯´å¯¼å…¥åé¢çš„å››ä¸ªåº“å³å¯ï¼Œä½†æ˜¯åœ¨æˆ‘é¡¹ç›®ä¸­å¦‚æœä»…å¯¼å…¥åå››ä¸ªåˆ™ä¼šæŠ¥é”™ï¼Œéœ€è¦å®Œæ•´å¯¼å…¥ä¸Šé¢çš„ä¾èµ–åº“ï¼Œä½ å¯ä»¥æ ¹æ®ä½ çš„å®é™…æƒ…å†µå¤„ç†ã€‚ï¼‰</p>
<ul>
<li>CoreMedia.framework</li>
<li>VideoToolbox.framework</li>
<li>AVFoundation.framework</li>
<li>AudioToolbox.framework</li>
<li>libstdc++.tbd</li>
<li>libbz2.tbd</li>
<li>libz.tbd</li>
<li>libiconv.tbd</li>
</ul>
</li>
<li><p>å¯¼å…¥å¤´æ–‡ä»¶</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#import <span class="meta-string">&lt;MobileVLCKit/MobileVLCKit.h&gt;</span></span></div></pre></td></tr></table></figure>
</li>
<li><p>å£°æ˜ä¸€ä¸ª<code>VLCMediaPlayer</code>ç±»å‹çš„å˜é‡</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ViewController</span> ()&lt;<span class="title">VLCMediaPlayerDelegate</span>&gt;</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) VLCMediaPlayer *mediaPlayer;</div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
</li>
<li><p>åˆå§‹åŒ–VLCMediaPlayer</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/* setup the media player instance, give it a delegate and something to draw into */</span></div><div class="line">_mediaPlayer = [[VLCMediaPlayer alloc] init];</div><div class="line">_mediaPlayer.delegate = <span class="keyword">self</span>;</div><div class="line">_mediaPlayer.drawable = <span class="keyword">self</span>.view;</div><div class="line"></div><div class="line"><span class="comment">/* create a media object and give it to the player */</span></div><div class="line">_mediaPlayer.media = [VLCMedia mediaWithURL:[<span class="built_in">NSURL</span> URLWithString:<span class="string">@"https://streams.videolan.org/streams/mp4/Mr_MrsSmith-h264_aac.mp4"</span>]];</div></pre></td></tr></table></figure>
</li>
<li><p>é»˜è®¤ä¸ä¼šè‡ªåŠ¨æ’­æ”¾è§†é¢‘ï¼Œéœ€è¦æˆ‘ä»¬æ‰‹åŠ¨è°ƒç”¨playæ–¹æ³•</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[_mediaPlayer play];</div></pre></td></tr></table></figure>
</li>
</ul>
<p>æ›´å¤šè£…Bç”¨æ³•è¯·è‡ªå·±å»æ¢ç´¢å§ï¼Œæ¯•ç«Ÿè‡£å¦¾ä¹Ÿä¸çŸ¥é“å•Š[æ‰‹åŠ¨ç¬‘å“­.png]~~~</p>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2018/02/26/iOS-compile-MobileVLCKit.framework/" class="archive-article-date">
  	<time datetime="2018-02-26T06:45:03.000Z" itemprop="datePublished"><i class="icon-clock"></i>2018-02-26</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li></ul>
	</div>

      

      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-iOS-weibo-usercenter" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/02/08/iOS-weibo-usercenter/">iOSä»¿æ–°æµªå¾®åšä¸ªäººé¡µé¢</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><p>Demoåœ°å€ï¼š<a href="https://github.com/xiaopin/weibo-UserCenter.git" target="_blank" rel="external">https://github.com/xiaopin/weibo-UserCenter.git</a></p>
<p>è¯¥Demoä¸­å¹¶æ²¡æœ‰å®ç°å¯¼èˆªæ é€æ˜æ•ˆæœï¼Œä¹Ÿæ²¡æä¸‹æ‹‰èƒŒæ™¯æ”¾å¤§çš„æ•ˆæœï¼Œæƒ³ç ”ç©¶è¿™äº›çš„å¯ä»¥å‡ºé—¨å·¦æ‹å»é—®åº¦å¨˜äº†ã€‚</p>
<h2 id="æ•ˆæœå›¾"><a href="#æ•ˆæœå›¾" class="headerlink" title="æ•ˆæœå›¾"></a>æ•ˆæœå›¾</h2><p><img src="/images/201802/weibo-preview.gif" alt="GIF"></p>
<h2 id="UIç»“æ„è¯´æ˜"><a href="#UIç»“æ„è¯´æ˜" class="headerlink" title="UIç»“æ„è¯´æ˜"></a>UIç»“æ„è¯´æ˜</h2><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæˆ‘æŠŠUIåˆ†ä¸ºä¸‰å¤§éƒ¨åˆ†ï¼š</p>
<p><img src="/images/201802/weibo-UI-description.png" alt="UIè¯´æ˜"></p>
<p>å®Œæ•´çš„UIå±‚çº§ç»“æ„æ ‘ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">UserCenterViewController.view</div><div class="line">â”‚</div><div class="line">â””â”€â”€ UserCenterScrollView</div><div class="line">	â”‚</div><div class="line">	â”œâ”€â”€ UserCenterHeaderView</div><div class="line">	â”‚</div><div class="line">	â”œâ”€â”€ UserCenterSegmentedView</div><div class="line">	â”‚</div><div class="line">	â””â”€â”€ UIPageViewController.view</div><div class="line">		â”‚</div><div class="line">		â”œâ”€â”€ HomeViewController.view</div><div class="line">		â”‚	â”‚</div><div class="line">		â”‚	â””â”€â”€ UITableView</div><div class="line">		â”‚</div><div class="line">		â”œâ”€â”€ WeiboListViewController.view</div><div class="line">		â”‚	â”‚</div><div class="line">		â”‚	â””â”€â”€ UITableView</div><div class="line">		â”‚</div><div class="line">		â””â”€â”€ AlbumViewController.view</div><div class="line">			â”‚</div><div class="line">			â””â”€â”€ UICollectionView</div></pre></td></tr></table></figure>
<h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><p>æˆ‘é‡‡ç”¨çš„æ˜¯UIScrollView+UIPageViewControlleræ¥å®ç°çš„ï¼ŒUIScrollViewä½œä¸ºæœ€åº•å±‚çš„å®¹å™¨è§†å›¾ï¼Œç®¡ç†ç€å¤´éƒ¨è§†å›¾ã€åˆ†æ®µæŒ‰é’®è§†å›¾ã€å†…å®¹è§†å›¾(å®é™…ä¸Šæ˜¯UIPageViewControllerçš„viewï¼Œç”±UIPageViewControlleræ¥å®ç°å·¦å³æ»‘åŠ¨åˆ‡æ¢å†…å®¹è§†å›¾æ§åˆ¶å™¨)ã€‚</p>
<p>ä»ä¸Šé¢çš„ç»“æ„ä¸­ä¹Ÿå¯ä»¥çœ‹å‡ºï¼Œå®é™…ä¸Šæ˜¯UIScrollViewåµŒå¥—UIScrollViewçš„èŒƒç•´äº†ï¼Œè¿™æ ·å°±æ¶‰åŠåˆ°äº†æ»šåŠ¨æ‰‹åŠ¿çš„å¤„ç†äº†ã€‚<br>æˆ‘æ˜¯è¿™æ ·å¤„ç†çš„ï¼Œé‡å†™äº†UserCenterScrollViewçš„<code>func gestureRecognizer(_ gestureRecognizer: UIGestureRecognizer, shouldRecognizeSimultaneouslyWith otherGestureRecognizer: UIGestureRecognizer) -&gt; Bool</code>æ–¹æ³•ï¼Œå¹¶é€šè¿‡è¿”å›trueæ¥åŒæ—¶ä½¿UserCenterScrollViewå’Œå†…å®¹è§†å›¾ä¸­çš„æ»šåŠ¨è§†å›¾å¯ä»¥åŒæ—¶æ¥æ”¶åˆ°æ»šåŠ¨æ‰‹åŠ¿äº‹ä»¶ï¼Œç„¶ååœ¨UserCenterViewControllerå®šä¹‰ä¸€ä¸ªæ ‡è®°è®°å½•UserCenterScrollViewæ˜¯å¦å¯ä»¥æ»šåŠ¨ï¼Œåœ¨UserCenterContentProxyViewControllerä¸­ä¹Ÿå®šä¹‰äº†ä¸€ä¸ªæ ‡è®°ç”¨äºè®°å½•å†…å®¹è§†å›¾æ˜¯å¦å¯ä»¥æ»šåŠ¨ã€‚é€šè¿‡è¿™ä¸¤ä¸ªæ ‡è®°çš„é…åˆä½¿ç”¨æ¥è¾¾åˆ°ä¸Šé¢çš„æ•ˆæœã€‚</p>
<p>å…·ä½“å®ç°è¿˜æ˜¯çœ‹ä»£ç å»å§ï¼Œä¸€è¡Œä»£ç èƒœäºåƒè¨€ä¸‡è¯­ã€‚</p>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2018/02/08/iOS-weibo-usercenter/" class="archive-article-date">
  	<time datetime="2018-02-08T06:02:01.000Z" itemprop="datePublished"><i class="icon-clock"></i>2018-02-08</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li></ul>
	</div>

      

      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-iOS-change-App-icon" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/01/16/iOS-change-App-icon/">iOSæ›´æ”¹Appå›¾æ ‡</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>è‹¹æœåœ¨iOS10.3ç³»ç»Ÿä¸­ä¸ºæˆ‘ä»¬å¸¦æ¥äº†æ›´æ”¹Appå›¾æ ‡çš„åŠŸèƒ½ï¼Œ ä¸»è¦æ¥å£å®šä¹‰å¦‚ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Pass `nil` to use the primary application icon. The completion handler will be invoked asynchronously on an arbitrary background queue; be sure to dispatch back to the main queue before doing any further UI work.</span></div><div class="line"><span class="meta">@available</span>(iOS <span class="number">10.3</span>, *)</div><div class="line">open <span class="function"><span class="keyword">func</span> <span class="title">setAlternateIconName</span><span class="params">(<span class="number">_</span> alternateIconName: String?, completionHandler: <span class="params">(<span class="params">(Error?)</span></span></span></span> -&gt; <span class="type">Swift</span>.<span class="type">Void</span>)? = <span class="literal">nil</span>)</div></pre></td></tr></table></figure>
<p>åœ¨ä½¿ç”¨è¯¥åŠŸèƒ½å‰ï¼Œæˆ‘ä»¬éœ€è¦æ³¨æ„ä¸€ä¸‹å‡ ç‚¹ï¼š</p>
<ul>
<li>iOS10.3æˆ–ä»¥ä¸Šç³»ç»Ÿç‰ˆæœ¬</li>
<li>åœ¨Info.plistä¸­å£°æ˜äº†ä¸»å›¾æ ‡å’Œå¤‡ç”¨å›¾æ ‡ï¼Œåªèƒ½ä½¿ç”¨å£°æ˜è¿‡çš„å›¾æ ‡ï¼Œå¹¶ä¸”iPhoneå’ŒiPadéœ€è¦åˆ†åˆ«å£°æ˜</li>
<li><code>UIApplication.shared.supportsAlternateIcons</code>è¿”å›trueæ—¶æ‰èƒ½ä¿®æ”¹å›¾æ ‡</li>
<li>å¤‡ç”¨å›¾æ ‡ä¸èƒ½æ”¾åœ¨<code>Assets.xcassets</code>ï¼Œå¿…é¡»æ˜¯ç›´æ¥æ‹–åˆ°Xcodeå·¦ä¾§çš„é¡¹ç›®å¯¼èˆªæ ä¸Š</li>
<li>å›¾æ ‡ä¿®æ”¹æˆåŠŸåï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å¼¹å‡ºä¸€ä¸ªå¼¹çª—è¿›è¡Œæç¤º</li>
</ul>
<h2 id="ä¸‹é¢è®©æˆ‘ä»¬æèµ·æ¥å§ï½ï½ï½"><a href="#ä¸‹é¢è®©æˆ‘ä»¬æèµ·æ¥å§ï½ï½ï½" class="headerlink" title="ä¸‹é¢è®©æˆ‘ä»¬æèµ·æ¥å§ï½ï½ï½"></a>ä¸‹é¢è®©æˆ‘ä»¬æèµ·æ¥å§ï½ï½ï½</h2><h3 id="1-æŠŠå¤‡ç”¨å›¾æ ‡æ‹–å…¥é¡¹ç›®ä¸­"><a href="#1-æŠŠå¤‡ç”¨å›¾æ ‡æ‹–å…¥é¡¹ç›®ä¸­" class="headerlink" title="1. æŠŠå¤‡ç”¨å›¾æ ‡æ‹–å…¥é¡¹ç›®ä¸­"></a>1. æŠŠå¤‡ç”¨å›¾æ ‡æ‹–å…¥é¡¹ç›®ä¸­</h3><p>çœ‹èµ·æ¥åº”è¯¥æ˜¯è¿™æ ·çš„</p>
<p><img src="/images/201801/alternateicon.png" alt=""></p>
<h3 id="2-åœ¨Info-plistä¸­å£°æ˜ä¸»å›¾æ ‡å’Œå¤‡ç”¨å›¾æ ‡"><a href="#2-åœ¨Info-plistä¸­å£°æ˜ä¸»å›¾æ ‡å’Œå¤‡ç”¨å›¾æ ‡" class="headerlink" title="2. åœ¨Info.plistä¸­å£°æ˜ä¸»å›¾æ ‡å’Œå¤‡ç”¨å›¾æ ‡"></a>2. åœ¨Info.plistä¸­å£°æ˜ä¸»å›¾æ ‡å’Œå¤‡ç”¨å›¾æ ‡</h3><p><code>CFBundleIcons</code>å£°æ˜çš„æ˜¯iPhoneä½¿ç”¨çš„å›¾æ ‡ï¼ŒiPadéœ€è¦ä½¿ç”¨<code>CFBundleIcons~ipad</code>è¿›è¡Œå£°æ˜ã€‚</p>
<p><code>CFBundlePrimaryIcon</code>å£°æ˜çš„å°±æ˜¯æˆ‘ä»¬Appçš„ä¸»å›¾æ ‡ï¼ˆåœ¨iOS11.2æ¨¡æ‹Ÿå™¨ä¸Šæµ‹è¯•ï¼Œå‘ç°ä¸æ·»åŠ è¯¥å­—æ®µç¨‹åºä¹Ÿèƒ½æ­£å¸¸è¿è¡Œï¼‰ï¼Œè€Œ<code>CFBundleAlternateIcons</code>å£°æ˜çš„å°±æ˜¯æˆ‘ä»¬çš„å¤‡ç”¨å›¾æ ‡ï¼Œè¯¥å­—æ®µå¯¹åº”çš„å€¼æ˜¯ä¸€ä¸ªå­—å…¸å€¼ï¼Œå­—å…¸ä¸‹é¢åˆæ˜¯å­—å…¸:)ï¼Œä½ å¯ä»¥é€šè¿‡æ·»åŠ å¤šä¸ªå­—å…¸æ¥æ·»åŠ å¤šä¸ªå¤‡ç”¨å›¾æ ‡ã€‚</p>
<p>ä¸‹é¢çš„ç¤ºä¾‹ä¸­æˆ‘å£°æ˜äº†ä¸¤ä¸ªå¤‡ç”¨å›¾æ ‡ã€‚</p>
<p>å­—æ®µå«ä¹‰å¯å‚è€ƒå®˜æ–¹æ–‡æ¡£: <a href="https://developer.apple.com/library/content/documentation/General/Reference/InfoPlistKeyReference/Articles/CoreFoundationKeys.html#//apple_ref/doc/uid/TP40009249-SW10" target="_blank" rel="external">ğŸ‘‡æˆ³è¿™é‡Œ</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div></pre></td><td class="code"><pre><div class="line">&lt;key&gt;CFBundleIcons&lt;/key&gt;</div><div class="line">&lt;dict&gt;</div><div class="line">    &lt;key&gt;CFBundleAlternateIcons&lt;/key&gt;</div><div class="line">    &lt;dict&gt;</div><div class="line">        &lt;key&gt;AppAlternateIcon&lt;/key&gt;</div><div class="line">        &lt;dict&gt;</div><div class="line">            &lt;key&gt;CFBundleIconFiles&lt;/key&gt;</div><div class="line">            &lt;array&gt;</div><div class="line">                &lt;string&gt;AppAlternateIcon&lt;/string&gt;</div><div class="line">            &lt;/array&gt;</div><div class="line">            &lt;key&gt;UIPrerenderedIcon&lt;/key&gt;</div><div class="line">            &lt;false/&gt;</div><div class="line">        &lt;/dict&gt;</div><div class="line">        &lt;key&gt;AppAlternateIcon2&lt;/key&gt;</div><div class="line">        &lt;dict&gt;</div><div class="line">            &lt;key&gt;CFBundleIconFiles&lt;/key&gt;</div><div class="line">            &lt;array&gt;</div><div class="line">                &lt;string&gt;AppAlternateIcon2&lt;/string&gt;</div><div class="line">            &lt;/array&gt;</div><div class="line">            &lt;key&gt;UIPrerenderedIcon&lt;/key&gt;</div><div class="line">            &lt;false/&gt;</div><div class="line">        &lt;/dict&gt;</div><div class="line">    &lt;/dict&gt;</div><div class="line">    &lt;key&gt;CFBundlePrimaryIcon&lt;/key&gt;</div><div class="line">    &lt;dict&gt;</div><div class="line">        &lt;key&gt;CFBundleIconFiles&lt;/key&gt;</div><div class="line">        &lt;array&gt;</div><div class="line">            &lt;string&gt;AppIcon60x60&lt;/string&gt;</div><div class="line">        &lt;/array&gt;</div><div class="line">    &lt;/dict&gt;</div><div class="line">&lt;/dict&gt;</div><div class="line">&lt;key&gt;CFBundleIcons~ipad&lt;/key&gt;</div><div class="line">&lt;dict&gt;</div><div class="line">    &lt;key&gt;CFBundleAlternateIcons&lt;/key&gt;</div><div class="line">    &lt;dict&gt;</div><div class="line">        &lt;key&gt;AppAlternateIconiPad&lt;/key&gt;</div><div class="line">        &lt;dict&gt;</div><div class="line">            &lt;key&gt;CFBundleIconFiles&lt;/key&gt;</div><div class="line">            &lt;array&gt;</div><div class="line">                &lt;string&gt;AppAlternateIconiPad&lt;/string&gt;</div><div class="line">            &lt;/array&gt;</div><div class="line">            &lt;key&gt;UIPrerenderedIcon&lt;/key&gt;</div><div class="line">            &lt;false/&gt;</div><div class="line">        &lt;/dict&gt;</div><div class="line">        &lt;key&gt;AppAlternateIconiPad2&lt;/key&gt;</div><div class="line">        &lt;dict&gt;</div><div class="line">            &lt;key&gt;CFBundleIconFiles&lt;/key&gt;</div><div class="line">            &lt;array&gt;</div><div class="line">                &lt;string&gt;AppAlternateIconiPad2&lt;/string&gt;</div><div class="line">            &lt;/array&gt;</div><div class="line">            &lt;key&gt;UIPrerenderedIcon&lt;/key&gt;</div><div class="line">            &lt;false/&gt;</div><div class="line">        &lt;/dict&gt;</div><div class="line">    &lt;/dict&gt;</div><div class="line">    &lt;key&gt;CFBundlePrimaryIcon&lt;/key&gt;</div><div class="line">    &lt;dict&gt;</div><div class="line">        &lt;key&gt;CFBundleIconFiles&lt;/key&gt;</div><div class="line">        &lt;array&gt;</div><div class="line">            &lt;string&gt;AppIcon83.5x83.5&lt;/string&gt;</div><div class="line">        &lt;/array&gt;</div><div class="line">    &lt;/dict&gt;</div><div class="line">&lt;/dict&gt;</div></pre></td></tr></table></figure>
<h3 id="3-ä¸‡äº‹ä¿±å¤‡ï¼Œç°åœ¨å¼€å§‹æ›´æ¢å›¾æ ‡"><a href="#3-ä¸‡äº‹ä¿±å¤‡ï¼Œç°åœ¨å¼€å§‹æ›´æ¢å›¾æ ‡" class="headerlink" title="3. ä¸‡äº‹ä¿±å¤‡ï¼Œç°åœ¨å¼€å§‹æ›´æ¢å›¾æ ‡"></a>3. ä¸‡äº‹ä¿±å¤‡ï¼Œç°åœ¨å¼€å§‹æ›´æ¢å›¾æ ‡</h3><p>ç›´æ¥ä¸Šä»£ç (ç‚¹å‡»æŒ‰é’®ï¼Œç„¶åç”Ÿæˆä¸€ä¸ªéšæœºæ•°ï¼Œæ ¹æ®éšæœºæ•°è·å–ç›¸åº”çš„å¤‡ç”¨å›¾æ ‡)ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@IBAction</span> <span class="function"><span class="keyword">func</span> <span class="title">buttonAction</span><span class="params">(<span class="number">_</span> sender: UIButton)</span></span> &#123;</div><div class="line">    <span class="keyword">if</span> #available(iOS <span class="number">10.3</span>, *) &#123;</div><div class="line">        <span class="keyword">if</span> !<span class="type">UIApplication</span>.shared.supportsAlternateIcons &#123;</div><div class="line">            <span class="keyword">return</span></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">let</span> random = arc4random_uniform(<span class="number">3</span>)</div><div class="line">        <span class="keyword">let</span> iPad = (<span class="type">UI_USER_INTERFACE_IDIOM</span>() == .pad)</div><div class="line">        <span class="keyword">var</span> iconName: <span class="type">String</span>? <span class="comment">// nilè¡¨ç¤ºä½¿ç”¨AppåŸæ¥çš„å›¾æ ‡</span></div><div class="line"></div><div class="line">        <span class="keyword">if</span> random == <span class="number">1</span> &#123; <span class="comment">// å›¾æ ‡1</span></div><div class="line">            iconName = iPad ? <span class="string">"AppAlternateIconiPad"</span> : <span class="string">"AppAlternateIcon"</span></div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> random == <span class="number">2</span> &#123; <span class="comment">// å›¾æ ‡2</span></div><div class="line">            iconName = iPad ? <span class="string">"AppAlternateIconiPad2"</span> : <span class="string">"AppAlternateIcon2"</span></div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">if</span> <span class="type">UIApplication</span>.shared.alternateIconName == iconName &#123;</div><div class="line">            <span class="comment">// Appå›¾æ ‡å·²æ˜¯å½“å‰é€‰ä¸­çš„å›¾æ ‡ï¼Œæ— éœ€æ›´æ¢</span></div><div class="line">            <span class="keyword">return</span></div><div class="line">        &#125;</div><div class="line">        <span class="type">UIApplication</span>.shared.setAlternateIconName(iconName, completionHandler: <span class="literal">nil</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="4-No-Demo-No-BB"><a href="#4-No-Demo-No-BB" class="headerlink" title="4. No Demo No BB"></a>4. No Demo No BB</h3><p>æœ€åé™„ä¸Š<a href="https://github.com/xiaopin/AlternateIconDemo.git" target="_blank" rel="external">Demo</a></p>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2018/01/16/iOS-change-App-icon/" class="archive-article-date">
  	<time datetime="2018-01-16T07:50:03.000Z" itemprop="datePublished"><i class="icon-clock"></i>2018-01-16</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li></ul>
	</div>

      

      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-iOS-open-QQ-chat" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/01/16/iOS-open-QQ-chat/">iOSæ‰“å¼€QQä¸´æ—¶ä¼šè¯çª—å£</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>å‰ææ¡ä»¶ï¼šæ¥æ”¶ä¸´æ—¶ä¼šè¯çš„QQå·ç å¿…é¡»å¼€é€š<a href="http://shang.qq.com" target="_blank" rel="external">QQæ¨å¹¿</a>åŠŸèƒ½ï¼Œå¦åˆ™ä¸èƒ½æ‰“å¼€ä¸´æ—¶ä¼šè¯çª—å£ã€‚</p>
</blockquote>
<p>å…¬å¸é¡¹ç›®åœ¨å•†å“è¯¦æƒ…é¡µé¢ä¸­ï¼Œæœ‰ä¸€ä¸ªå®¢æœæŒ‰é’®ï¼Œç‚¹å‡»åéœ€è¦æ‰“å¼€å®¢æœMMçš„QQèŠå¤©çª—å£ï¼Œåœ¨æ­¤å¯ä»¥å‘å®¢æœMMå’¨è¯¢å•†å“ç›¸å…³çš„é—®é¢˜ã€‚è¿™é‡Œå°±è®°å½•ä¸‹iOSå¦‚ä½•è·³è½¬åˆ°QQçš„èŠå¤©çª—å£ã€‚</p>
<ul>
<li>åœ¨Info.pliseä¸­åŠ å…¥ç™½åå•</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;key&gt;LSApplicationQueriesSchemes&lt;/key&gt;</div><div class="line">&lt;array&gt;</div><div class="line">    &lt;string&gt;mqq&lt;/string&gt;</div><div class="line">&lt;/array&gt;</div></pre></td></tr></table></figure>
<ul>
<li>ç¤ºä¾‹ä»£ç </li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> <span class="type">UIApplication</span>.shared.canOpenURL(<span class="type">URL</span>(string: <span class="string">"mqq://"</span>)!) &#123;</div><div class="line">    <span class="keyword">let</span> qq = <span class="string">"12345678"</span></div><div class="line">    <span class="keyword">if</span> <span class="keyword">let</span> url = <span class="type">URL</span>(string: <span class="string">"mqq://im/chat?chat_type=wpa&amp;uin=<span class="subst">\(qq)</span>&amp;version=1&amp;src_type=web"</span>) &#123;</div><div class="line">        <span class="keyword">if</span> #available(iOS <span class="number">10.0</span>, *) &#123;</div><div class="line">            <span class="type">UIApplication</span>.shared.open(url, options: [:], completionHandler: <span class="literal">nil</span>)</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="type">UIApplication</span>.shared.openURL(url)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2018/01/16/iOS-open-QQ-chat/" class="archive-article-date">
  	<time datetime="2018-01-16T07:03:50.000Z" itemprop="datePublished"><i class="icon-clock"></i>2018-01-16</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li></ul>
	</div>

      

      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  


      </div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2018 å´å“è¯š
    	</div>
      <a href="http://www.miitbeian.gov.cn/" target="_blank">ç²¤ICPå¤‡18042388å·-1</a>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    <script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: false,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false,
		root: "/",
		innerArchive: true
	}
</script>

<script src="/./main.js"></script>


    
<div class="tools-col">
  <ul class="btn-wrap">
    
      <li class="chose" data-hook="tools-section-all"><span class="text">å…¨éƒ¨</span><i class="icon-book"></i></li>
    
    
      <li data-hook="tools-section-tag"><span class="text">æ ‡ç­¾</span><i class="icon-price-tags"></i></li>
    
    
      <li data-hook="tools-section-friends"><span class="text">å‹é“¾</span><i class="icon-link"></i></li>
    
    
      <li data-hook="tools-section-me"><span class="text">æˆ‘</span><i class="icon-smile"></i></li>
    
  </ul>
  <div class="tools-wrap">
    
    	<section class="tools-section tools-section-all chose">
    	</section>
    

    
    	<section class="tools-section tools-section-tag">
    			<div class="widget tagcloud" id="js-tagcloud">
    				<a href="/tags/Android/" style="font-size: 10px;">Android</a> <a href="/tags/JavaScript/" style="font-size: 15px;">JavaScript</a> <a href="/tags/Python/" style="font-size: 10px;">Python</a> <a href="/tags/Swift/" style="font-size: 17.5px;">Swift</a> <a href="/tags/iOS/" style="font-size: 20px;">iOS</a> <a href="/tags/macOS/" style="font-size: 12.5px;">macOS</a> <a href="/tags/éšè®°/" style="font-size: 10px;">éšè®°</a>
    			</div>
    	</section>
    

    
    	<section class="tools-section tools-section-friends">
  		
  			<div class="friends-wrap" id="js-friends">
  			
  	          <a target="_blank" class="main-nav-link switch-friends-link" href="https://onevcat.com/#blog">ç‹å·åšå®¢</a>
  	        
  	          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.devtang.com/">å”å·§åšå®¢</a>
  	        
  	          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.liaoxuefeng.com/">å»–é›ªå³°çš„å®˜æ–¹ç½‘ç«™</a>
  	        
  	          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.skyfox.org/">å¤©ç‹åšå®¢</a>
  	        
  	          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.kittenyang.com/">Kittenåšå®¢</a>
  	        
  	          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.limboy.me/">æå¿ (è˜‘è‡è¡—)åšå®¢</a>
  	        
  	          <a target="_blank" class="main-nav-link switch-friends-link" href="https://blog.sunnyyoung.net/">Sunnyyoungåšå®¢</a>
  	        
  	          <a target="_blank" class="main-nav-link switch-friends-link" href="https://objccn.io/">ObjCä¸­å›½</a>
  	        
  	          <a target="_blank" class="main-nav-link switch-friends-link" href="http://nshipster.cn/">NSHipster</a>
  	        
  	          <a target="_blank" class="main-nav-link switch-friends-link" href="http://es6.ruanyifeng.com/">é˜®ä¸€å³°ECMAScript6å…¥é—¨</a>
  	        
  	          <a target="_blank" class="main-nav-link switch-friends-link" href="https://git-scm.com/book/zh/v2/">Git Document</a>
  	        
  	          <a target="_blank" class="main-nav-link switch-friends-link" href="https://tinypng.com/">å›¾ç‰‡åœ¨çº¿å‹ç¼©</a>
  	        
  	          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.cockos.com/licecap/">å±å¹•å½•åˆ¶GIF</a>
  	        
  	          <a target="_blank" class="main-nav-link switch-friends-link" href="https://developer.apple.com/library/">Apple Developer</a>
  	        
  	          <a target="_blank" class="main-nav-link switch-friends-link" href="https://developer.apple.com/app-store/review/guidelines/cn/">App Store å®¡æ ¸æŒ‡å—</a>
  	        
  	          <a target="_blank" class="main-nav-link switch-friends-link" href="https://developers.google.cn/">Google Developer</a>
  	        
  	          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.iconfont.cn/">é˜¿é‡Œå·´å·´çŸ¢é‡å›¾æ ‡åº“</a>
  	        
  	          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.nsdateformatter.com/">NSDateæ—¥æœŸæ ¼å¼</a>
  	        
  	          <a target="_blank" class="main-nav-link switch-friends-link" href="https://developer.apple.com/support/app-store/">iOSç‰ˆæœ¬åˆ†å¸ƒæƒ…å†µ</a>
  	        
  	          <a target="_blank" class="main-nav-link switch-friends-link" href="https://bugly.qq.com/docs/user-guide/symbol-configuration-ios/?v=20170627170213">iOSç¬¦å·è¡¨</a>
  	        
  	          <a target="_blank" class="main-nav-link switch-friends-link" href="https://developer.apple.com/library/content/documentation/DeviceInformation/Reference/iOSDeviceCompatibility/Displays/Displays.html#//apple_ref/doc/uid/TP40013599-CH108-SW6">iPhoneå°ºå¯¸</a>
  	        
  	        </div>
  		
    	</section>
    

    
    	<section class="tools-section tools-section-me">
  	  	
  	  		<div class="aboutme-wrap" id="js-aboutme">æˆ‘æ˜¯å´å“è¯šï¼Œæˆ‘å–‚è‡ªå·±è¢‹ç›......</div>
  	  	
    	</section>
    
  </div>
  
</div>
    <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>
  </div>
</body>
</html>